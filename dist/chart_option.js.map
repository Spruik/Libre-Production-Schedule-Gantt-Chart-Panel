{"version":3,"sources":["../src/chart_option.js"],"names":["getOption","data","_rawData","option","tooltip","animation","toolbox","left","top","itemSize","feature","myDrag","show","title","icon","onclick","onDragSwitchClick","text","dataZoom","type","xAxisIndex","filterMode","height","bottom","start","_bottomSliderDataZoomStart","end","_bottomSliderDataZoomEnd","handleIcon","handleSize","showDetail","handleStyle","shadowBlur","shadowOffsetX","shadowOffsetY","shadowColor","id","zoomOnMouseWheel","moveOnMouseMove","yAxisIndex","zoomLock","width","right","moveOnMouseWheel","grid","backgroundColor","borderWidth","xAxis","position","splitLine","lineStyle","color","axisLine","axisTick","axisLabel","inside","align","yAxis","min","max","line","length","series","renderItem","renderGanttItem","dimensions","order","formatter","startTime","moment","params","format","endTime","compl_qty","fi","borderColor","borderRadius","encode","x","DIM_TIME_ARRIVAL","DIM_TIME_DEPARTURE","y","DIM_CATEGORY_INDEX","renderAxisLabelItem","echarts","util","map","item","index","concat","api","status","value","dp","findIndex","getColor","highlightColor","utils","categoryIndex","timeArrival","coord","timeDeparture","coordSys","_cartesianXBounds","_cartesianYBounds","barLength","barHeight","size","HEIGHT_RATIO","flightNumber","flightNumberWidth","getTextRect","rectNormal","clipRectByRect","rectVIP","rectText","children","ignore","shape","style","fill","styleEmphasis","stroke","lineWidth","textFill","d","layout","textVerticalAlign","textAlign","rect","graphic","model","_draggable","console","log","_myChart","setOption","disabled","setIconStatus","interationSetup","myChart","panelCtrl","_panelCtrl","setListeners","initDrag","refreshDashboard","timeSrv","_autoDataZoomAnimator","makeAnimator","dispatchDataZoom","on","param","seriesIndex","_draggingRecord","dataIndex","cursorPositionX","event","offsetX","lineDash","_draggingEl","addOrUpdateBar","_draggingCursorOffset","offsetY","_draggingTimeLength","getZr","cursorX","cursorY","attr","prepareDrop","autoDataZoomWhenDraggingOutside","_dropRecord","updateRawData","dragRelease","stop","remove","_dropShadow","el","itemData","z","pointArrival","convertToPixel","pointDeparture","Math","abs","Rect","add","xPixel","yPixel","cursorData","convertFromPixel","floor","orderData","movingItem","i","dataItem","dropCtrl","showForm","mergeKeyVal","cursorDistX","getCursorCartesianDist","cursorDistY","optionInsideX","DATA_ZOOM_X_INSIDE_INDEX","optionInsideY","DATA_ZOOM_Y_INSIDE_INDEX","batch","prepareBatch","dispatchAction","cursorDist","sign","delta","DATA_ZOOM_AUTO_MOVE_SPEED","push","dataZoomId","cursorXY","bounds","dist0","DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH","dist1","callback","requestId","callbackParams","throttle","DATA_ZOOM_AUTO_MOVE_THROTTLE","onFrame","requestAnimationFrame","cancelAnimationFrame","off","order_actions","showOrderActions","localeCompare","key"],"mappings":"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","file":"chart_option.js","sourcesContent":["import * as dp from './data_processor'\nimport * as utils from './utils'\nimport * as order_actions from './order_actions_ctrl'\nimport * as dropCtrl from './drop_order_ctrl'\n\nimport echarts from './libs/echarts.min'\nimport moment from 'moment'\n\nlet HEIGHT_RATIO = 0.6;\nlet DIM_CATEGORY_INDEX = 0;\nlet DIM_TIME_ARRIVAL = 1;\nlet DIM_TIME_DEPARTURE = 2;\nlet DATA_ZOOM_AUTO_MOVE_THROTTLE = 30;\nlet DATA_ZOOM_X_INSIDE_INDEX = 1;\nlet DATA_ZOOM_Y_INSIDE_INDEX = 3;\nlet DATA_ZOOM_AUTO_MOVE_SPEED = 0.2;\nlet DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH = 30;\n\nlet _draggable;\nlet _draggingEl;\nlet _dropShadow;\nlet _draggingCursorOffset = [0, 0];\nlet _draggingTimeLength;\nlet _draggingRecord;\nlet _dropRecord;\nlet _cartesianXBounds = [];\nlet _cartesianYBounds = [];\nlet _rawData;\nlet _autoDataZoomAnimator;\n\nlet _myChart\nlet _panelCtrl\n\nlet _bottomSliderDataZoomStart\nlet _bottomSliderDataZoomEnd\n\nexport function getOption (data, ) {\n  \n  _rawData = data  \n  \n  let option = {\n    tooltip: {\n    },\n    animation: false,\n    toolbox: {\n        left: 20,\n        top: 0,\n        itemSize: 20,\n        feature: {\n            myDrag: {\n                show: true,\n                title: 'Make orders\\ndraggable',\n                icon: 'path://M990.55 380.08 q11.69 0 19.88 8.19 q7.02 7.01 7.02 18.71 l0 480.65 q-1.17 43.27 -29.83 71.93 q-28.65 28.65 -71.92 29.82 l-813.96 0 q-43.27 -1.17 -72.5 -30.41 q-28.07 -28.07 -29.24 -71.34 l0 -785.89 q1.17 -43.27 29.24 -72.5 q29.23 -29.24 72.5 -29.24 l522.76 0 q11.7 0 18.71 7.02 q8.19 8.18 8.19 18.71 q0 11.69 -7.6 19.29 q-7.6 7.61 -19.3 7.61 l-518.08 0 q-22.22 1.17 -37.42 16.37 q-15.2 15.2 -15.2 37.42 l0 775.37 q0 23.39 15.2 38.59 q15.2 15.2 37.42 15.2 l804.6 0 q22.22 0 37.43 -15.2 q15.2 -15.2 16.37 -38.59 l0 -474.81 q0 -11.7 7.02 -18.71 q8.18 -8.19 18.71 -8.19 l0 0 ZM493.52 723.91 l-170.74 -170.75 l509.89 -509.89 q23.39 -23.39 56.13 -21.05 q32.75 1.17 59.65 26.9 l47.94 47.95 q25.73 26.89 27.49 59.64 q1.75 32.75 -21.64 57.3 l-508.72 509.9 l0 0 ZM870.09 80.69 l-56.13 56.14 l94.72 95.9 l56.14 -57.31 q8.19 -9.35 8.19 -21.05 q-1.17 -12.86 -10.53 -22.22 l-47.95 -49.12 q-10.52 -9.35 -23.39 -9.35 q-11.69 -1.17 -21.05 7.01 l0 0 ZM867.75 272.49 l-93.56 -95.9 l-380.08 380.08 l94.73 94.73 l378.91 -378.91 l0 0 ZM322.78 553.16 l38.59 39.77 l-33.92 125.13 l125.14 -33.92 l38.59 38.6 l-191.79 52.62 q-5.85 1.17 -12.28 0 q-6.44 -1.17 -11.11 -5.84 q-4.68 -4.68 -5.85 -11.7 q-2.34 -5.85 0 -11.69 l52.63 -192.97 l0 0 Z',\n                onclick: onDragSwitchClick\n            }\n        }\n    },\n    title: {\n        text: '',\n        left: 'center'\n    },\n    dataZoom: [{\n      type: 'slider',\n      xAxisIndex: 0,\n      filterMode: 'weakFilter',\n      height: 10,\n      bottom: 8,\n      start: _bottomSliderDataZoomStart || 0,\n      end: _bottomSliderDataZoomEnd || 100,\n      handleIcon: 'M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',\n      handleSize: 15,\n      showDetail: false,\n      handleStyle: {\n          shadowBlur: 6,\n          shadowOffsetX: 1,\n          shadowOffsetY: 2,\n          shadowColor: '#aaa'\n      },\n    }, {\n        type: 'inside',\n        id: 'insideX',\n        xAxisIndex: 0,\n        filterMode: 'weakFilter',\n        start: 0,\n        end: 26,\n        zoomOnMouseWheel: false,\n        moveOnMouseMove: true\n    }, {\n        type: 'slider',\n        yAxisIndex: 0,\n        zoomLock: true,\n        width: 10,\n        right: 10,\n        top: 70,\n        bottom: 20,\n        start: 0,\n        end: 100,\n        handleSize: 0,\n        showDetail: false,\n    }, {\n        type: 'inside',\n        id: 'insideY',\n        yAxisIndex: 0,\n        start: 0,\n        end: 100,\n        zoomOnMouseWheel: false,\n        moveOnMouseMove: true,\n        moveOnMouseWheel: true\n    }],\n    grid: {\n        show: true,\n        top: 70,\n        bottom: 20,\n        left: 260,\n        right: 20,\n        backgroundColor: '#fff',\n        borderWidth: 0\n    },\n    xAxis: {\n        type: 'time',\n        position: 'top',\n        splitLine: {\n            lineStyle: {\n                color: ['#E9EDFF']\n            }\n        },\n        axisLine: {\n            show: false\n        },\n        axisTick: {\n            lineStyle: {\n                color: '#929ABA'\n            }\n        },\n        axisLabel: {\n            color: '#929ABA',\n            inside: false,\n            align: 'center'\n        }\n    },\n    yAxis: {\n        axisTick: {show: false},\n        splitLine: {show: false},\n        axisLine: {show: false},\n        axisLabel: {show: false},\n        min: 0,\n        max: _rawData.line.data.length\n    },\n    series: [\n      {\n        id: 'flightData',\n        type: 'custom',\n        renderItem: renderGanttItem,\n        dimensions: _rawData.order.dimensions,\n        tooltip: {\n            formatter: params => {\n                \n                const startTime = moment(params.data[1]).format('YYYY-MM-DD H:mm:ss')\n                const endTime = moment(params.data[2]).format('YYYY-MM-DD H:mm:ss')\n                const compl_qty = params.data[fi('compl_qty')] === null ? 0 : params.data[fi('compl_qty')]\n\n                let tooltip = '<p style=\"text-align:center;margin:0px;color:#999\">Order ID : ' + params.data[fi('order_id')] + '</p>'\n                tooltip += '<div style=\"margin:5px 0px 5px 0px; width:100%; height:1px; background: #999\"></div>'\n                if (params.data[fi('status')]  === 'Changeover') {\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Change-Over </strong></p> '\n                }else {\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Planned Qty :</strong> &nbsp;' + params.data[fi('order_qty')] + '</p> '\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Confirmed Qty :</strong> &nbsp;' + compl_qty + '</p> '\n                }\n                tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Start Time :</strong> &nbsp;' + startTime + '</p> '\n                tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">End Time :</strong> &nbsp;' + endTime + '</p> '\n                return tooltip\n            },\n            backgroundColor: '#eee',\n            borderColor: '#aaa',\n            borderWidth: 1,\n            borderRadius: 4,\n        },\n        encode: {\n            x: [DIM_TIME_ARRIVAL, DIM_TIME_DEPARTURE],\n            y: DIM_CATEGORY_INDEX,\n        },\n        data: _rawData.order.data\n      },\n      {\n        type: 'custom',\n        renderItem: renderAxisLabelItem,\n        dimensions: _rawData.line.dimensions,\n        encode: {\n            x: -1, // Then this series will not controlled by x.\n            y: 0\n        },\n        data: echarts.util.map(_rawData.line.data, function (item, index) {\n            return [index].concat(item);\n        })\n      }\n    ]\n  }\n\n  return option\n}\n\nfunction renderGanttItem(params, api) {\n  \n  let status = api.value(dp.findIndex('status', _rawData.order.dimensions))\n  const color = dp.getColor(status)\n  const highlightColor = utils.highlightColor(color)\n  \n  var categoryIndex = api.value(DIM_CATEGORY_INDEX);\n  var timeArrival = api.coord([api.value(DIM_TIME_ARRIVAL), categoryIndex]);\n  var timeDeparture = api.coord([api.value(DIM_TIME_DEPARTURE), categoryIndex]);\n\n  var coordSys = params.coordSys;\n  _cartesianXBounds[0] = coordSys.x;\n  _cartesianXBounds[1] = coordSys.x + coordSys.width;\n  _cartesianYBounds[0] = coordSys.y;\n  _cartesianYBounds[1] = coordSys.y + coordSys.height;\n\n  var barLength = timeDeparture[0] - timeArrival[0];\n  // Get the heigth corresponds to length 1 on y axis.\n  var barHeight = api.size([0, 1])[1] * HEIGHT_RATIO;\n  var x = timeArrival[0];\n  var y = timeArrival[1] - barHeight;\n\n  var flightNumber = status === 'Changeover' ? 'C' : api.value(4) + ''\n  var flightNumberWidth = echarts.format.getTextRect(flightNumber).width;\n  var text = (barLength > flightNumberWidth + 40 && x + barLength >= 180)\n      ? flightNumber : '';\n\n  var rectNormal = clipRectByRect(params, {\n      x: x, y: y, width: barLength, height: barHeight\n  });\n  var rectVIP = clipRectByRect(params, {\n      x: x, y: y, width: (barLength) / 2, height: barHeight\n  });\n  var rectText = clipRectByRect(params, {\n      x: x, y: y, width: barLength, height: barHeight\n  });\n\n  return {\n      type: 'group',\n      children: [{\n          type: 'rect',\n          ignore: !rectNormal,\n          shape: rectNormal,\n          style: api.style({fill: color}),\n          styleEmphasis: {fill: highlightColor}\n      }, \n      {\n          type: 'rect',\n          ignore: !rectVIP && !api.value(4),\n          shape: rectVIP,\n          style: api.style({fill: color}),\n          styleEmphasis: {fill: highlightColor}\n      }, \n      {\n          type: 'rect',\n          ignore: !rectText,\n          shape: rectText,\n          style: api.style({\n              fill: 'transparent',\n              stroke: '#000000',\n              lineWidth: 0.5,\n              text: text,\n              textFill: '#fff'\n          })\n      }]\n  };\n}\n\nfunction renderAxisLabelItem(params, api) {\n  var y = api.coord([0, api.value(0)])[1];\n  if (y < params.coordSys.y + 5) {\n      return;\n  }\n  return {\n      type: 'group',\n      position: [\n          10,\n          y\n      ],\n      children: [{\n          type: 'path',\n          shape: {\n              d: 'M0,0 L0,-20 L30,-20 C42,-20 38,-1 50,-1 L70,-1 L70,0 Z',\n              x: 0,\n              y: -20,\n              width: 250,\n              height: 20,\n              layout: 'cover'\n          },\n          style: {\n              fill: '#368c6c'\n          }\n      }, {\n          type: 'text',\n          style: {\n              x: 54,\n              y: -3,\n              text: api.value(1),\n              textVerticalAlign: 'bottom',\n              textAlign: 'center',\n              textFill: '#fff'\n          }\n      }, {\n          type: 'text',\n          style: {\n              x: 200,\n              y: -2,\n              textVerticalAlign: 'bottom',\n              textAlign: 'center',\n              text: api.value(2),\n              textFill: '#000'\n          }\n      }]\n  };\n}\n\n\nfunction clipRectByRect(params, rect) {\n  return echarts.graphic.clipRectByRect(rect, {\n    x: params.coordSys.x,\n    y: params.coordSys.y,\n    width: params.coordSys.width,\n    height: params.coordSys.height\n  });\n}\n\n\n//--------------------------------------------\n\nfunction onDragSwitchClick(model, api, type) {\n  _draggable = !_draggable;\n  console.log('here');\n  _myChart.setOption({\n      dataZoom: [{\n          id: 'insideX',\n          disabled: _draggable\n      }, {\n          id: 'insideY',\n          disabled: _draggable\n      }]\n  });\n  this.model.setIconStatus(type, _draggable ? 'emphasis' : 'normal');\n}\n\nexport function interationSetup(myChart, panelCtrl){\n  _myChart = myChart\n  _panelCtrl = panelCtrl\n  \n  //set listeners like onclick...\n  setListeners(myChart)\n\n  //init drag function\n  initDrag(myChart)\n}\n\nexport function refreshDashboard(){\n  _panelCtrl.timeSrv.refreshDashboard()\n}\n\nfunction initDrag(myChart){\n  console.log('here');\n  _autoDataZoomAnimator = makeAnimator(dispatchDataZoom);\n  myChart.on('mousedown', function (param) {\n    // console.log(param.event.offsetX);\n    \n    if (!_draggable || !param || param.seriesIndex === null) {\n      return;\n    }\n    // Drag start\n    _draggingRecord = {\n      dataIndex: param.dataIndex,\n      categoryIndex: param.value[DIM_CATEGORY_INDEX],\n      timeArrival: param.value[DIM_TIME_ARRIVAL],\n      timeDeparture: param.value[DIM_TIME_DEPARTURE],\n      cursorPositionX: param.event.offsetX\n    };\n    var style = {lineWidth: 2, fill: 'rgba(255,0,0,0.1)', stroke: 'rgba(255,0,0,0.8)', lineDash: [6, 3]};\n\n    _draggingEl = addOrUpdateBar(_draggingEl, _draggingRecord, style, 100);\n    _draggingCursorOffset = [\n      _draggingEl.position[0] - param.event.offsetX,\n      _draggingEl.position[1] - param.event.offsetY\n    ];\n    _draggingTimeLength = _draggingRecord.timeDeparture - _draggingRecord.timeArrival;\n  });\n\n  myChart.getZr().on('mousemove', function (event) {\n    if (!_draggingEl) {\n      return;\n    }\n\n    var cursorX = event.offsetX;\n    var cursorY = event.offsetY;\n\n    // Move _draggingEl.\n    _draggingEl.attr('position', [\n      _draggingCursorOffset[0] + cursorX,\n      _draggingCursorOffset[1] + cursorY,\n    ]);\n\n    prepareDrop();\n\n    autoDataZoomWhenDraggingOutside(cursorX, cursorY);\n  });\n\n  myChart.getZr().on('mouseup', function () {\n    // Drop\n    if (_draggingEl && _dropRecord) {\n\n      updateRawData() && myChart.setOption({\n        series: {\n          id: 'flightData',\n          data: _rawData.order.data\n        }\n      });\n    }\n    dragRelease();\n  });\n  myChart.getZr().on('globalout', dragRelease);\n\n  function dragRelease() {\n    _autoDataZoomAnimator.stop();\n\n    if (_draggingEl) {\n      myChart.getZr().remove(_draggingEl);\n      _draggingEl = null;\n    }\n    if (_dropShadow) {\n      myChart.getZr().remove(_dropShadow);\n      _dropShadow = null;\n    }\n    _dropRecord = _draggingRecord = null;\n  }\n\n  function addOrUpdateBar(el, itemData, style, z) {\n    var pointArrival = myChart.convertToPixel('grid', [itemData.timeArrival, itemData.categoryIndex]);\n    //set item shadow to be in the cursor's position\n    if (itemData.cursorPositionX) {\n      pointArrival[0] = itemData.cursorPositionX - 10\n    }\n    var pointDeparture = myChart.convertToPixel('grid', [itemData.timeDeparture, itemData.categoryIndex]);\n\n    // var barLength = pointDeparture[0] - pointArrival[0];\n    var barLength = 20\n\n    var barHeight = Math.abs(\n      myChart.convertToPixel('grid', [0, 0])[1] - myChart.convertToPixel('grid', [0, 1])[1]\n    ) * HEIGHT_RATIO;\n\n    if (!el) {\n      el = new echarts.graphic.Rect({\n        shape: {x: 0, y: 0, width: 0, height: 0},\n        style: style,\n        z: z\n      });\n      myChart.getZr().add(el);\n    }\n    el.attr({\n      shape: {x: 0, y: 0, width: barLength, height: barHeight},\n      position: [pointArrival[0], pointArrival[1] - barHeight]\n    });    \n    \n    return el;\n  }\n\n  function prepareDrop() {\n    // Check droppable place.\n    var xPixel = _draggingEl.shape.x + _draggingEl.position[0];\n    var yPixel = _draggingEl.shape.y + _draggingEl.position[1];\n    var cursorData = myChart.convertFromPixel('grid', [xPixel, yPixel]);      \n    \n    if (cursorData) {\n      // Make drop shadow and _dropRecord\n      _dropRecord = {\n        categoryIndex: Math.floor(cursorData[1]),\n        timeArrival: cursorData[0],\n        timeDeparture: cursorData[0] + _draggingTimeLength\n      };\n      var style = {fill: 'rgba(0,0,0,0.4)'};\n      _dropShadow = addOrUpdateBar(_dropShadow, _dropRecord, style, 99);\n    }\n  }\n\n  // This is some business logic, don't care about it.\n  function updateRawData() {\n    const orderData = _rawData.order.data;\n    let movingItem = orderData[_draggingRecord.dataIndex];\n    //If the dragging item is a changeover item, return.\n    if (movingItem[fi('status')] === 'Changeover') { return }\n    \n    // Check if hits anthoer order\n    for (let i = 0; i < orderData.length; i++) {\n      const dataItem = orderData[i];\n      \n      //if the dragging item is overlapped with changeover, return\n      if (dataItem[fi('status')] === 'Changeover') { return }\n      \n      //if hits another order, show form\n      if (dataItem !== movingItem\n        && _dropRecord.categoryIndex === dataItem[DIM_CATEGORY_INDEX]\n        && _dropRecord.timeArrival < dataItem[DIM_TIME_DEPARTURE]\n        && _dropRecord.timeArrival > dataItem[DIM_TIME_ARRIVAL]\n      ) {\n        dropCtrl.showForm(utils.mergeKeyVal(movingItem, _rawData.order.dimensions), utils.mergeKeyVal(dataItem, _rawData.order.dimensions))\n      }\n    }\n\n    return true;\n  }\n\n  function autoDataZoomWhenDraggingOutside(cursorX, cursorY) {\n      // When cursor is outside the cartesian and being dragging,\n      // auto move the dataZooms.\n      console.log('here2');\n      \n      var cursorDistX = getCursorCartesianDist(cursorX, _cartesianXBounds);\n      var cursorDistY = getCursorCartesianDist(cursorY, _cartesianYBounds);\n\n      if (cursorDistX !== 0 || cursorDistY !== 0) {\n        _autoDataZoomAnimator.start({\n            cursorDistX: cursorDistX,\n            cursorDistY: cursorDistY\n        });\n      }\n      else {\n        _autoDataZoomAnimator.stop();\n      }\n  }\n\n  function dispatchDataZoom(params) {\n    var option = myChart.getOption();\n    var optionInsideX = option.dataZoom[DATA_ZOOM_X_INSIDE_INDEX];\n    var optionInsideY = option.dataZoom[DATA_ZOOM_Y_INSIDE_INDEX];\n    var batch = [];\n\n    prepareBatch(batch, 'insideX', optionInsideX.start, optionInsideX.end, params.cursorDistX);\n    prepareBatch(batch, 'insideY', optionInsideY.start, optionInsideY.end, -params.cursorDistY);\n\n    batch.length && myChart.dispatchAction({\n      type: 'dataZoom',\n      batch: batch\n    });\n\n    function prepareBatch(batch, id, start, end, cursorDist) {      \n      if (cursorDist === 0) {\n          return;\n      }\n      var sign = cursorDist / Math.abs(cursorDist);\n      var size = end - start;\n      var delta = DATA_ZOOM_AUTO_MOVE_SPEED * sign;\n\n      start += delta;\n      end += delta;\n\n      if (end > 100) {\n          end = 100;\n          start = end - size;\n      }\n      if (start < 0) {\n          start = 0;\n          end = start + size;\n      }\n      batch.push({\n          dataZoomId: id,\n          start: start,\n          end: end\n      });\n    }\n  }\n\n  function getCursorCartesianDist(cursorXY, bounds) {\n    var dist0 = cursorXY - (bounds[0] + DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH);\n    var dist1 = cursorXY - (bounds[1] - DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH);\n    return dist0 * dist1 <= 0\n        ? 0 // cursor is in cartesian\n        : dist0 < 0\n        ? dist0 // cursor is at left/top of cartesian\n        : dist1; // cursor is at right/bottom of cartesian\n  }\n\n  function makeAnimator(callback) {\n    var requestId;\n    var callbackParams;\n    // Use throttle to prevent from calling dispatchAction frequently.\n    callback = echarts.throttle(callback, DATA_ZOOM_AUTO_MOVE_THROTTLE);\n\n    function onFrame() {\n        callback(callbackParams);\n        requestId = requestAnimationFrame(onFrame);\n    }\n\n    return {\n        start: function (params) {\n            callbackParams = params;\n            if (requestId == null) {\n                onFrame();\n            }\n        },\n        stop: function () {\n            if (requestId != null) {\n                cancelAnimationFrame(requestId);\n            }\n            requestId = callbackParams = null;\n        }\n    };\n  }\n}\n\n\n\nfunction setListeners(myChart){\n  myChart.off('click')\n  myChart.off('dataZoom')\n\n  myChart.on('click', params => {\n    if (!_draggable) {\n      if (params.data[fi('status')] !== 'Changeover') {\n        order_actions.showOrderActions(utils.mergeKeyVal(params.data, _rawData.order.dimensions))\n      }\n    }\n  })\n  myChart.on('dataZoom', params => {\n    if (params.dataZoomId.localeCompare('series00') === 0) {\n      _bottomSliderDataZoomStart = params.start\n      _bottomSliderDataZoomEnd = params.end\n      console.log('yes');\n    }\n  })\n}\n\n/**\n * Find the index that match the key in the order dimensions array\n * @param {*} key \n */\nfunction fi(key){\n  return dp.findIndex(key, _rawData.order.dimensions)\n}\n"]}