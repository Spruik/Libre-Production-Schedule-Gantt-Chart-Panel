{"version":3,"sources":["../src/chart_option.js"],"names":["getOption","data","_rawData","option","tooltip","animation","toolbox","left","top","itemSize","feature","myDrag","show","title","icon","onclick","onDragSwitchClick","text","dataZoom","type","xAxisIndex","filterMode","height","bottom","start","end","handleIcon","handleSize","showDetail","id","zoomOnMouseWheel","moveOnMouseMove","yAxisIndex","zoomLock","width","right","moveOnMouseWheel","grid","backgroundColor","borderWidth","xAxis","position","splitLine","lineStyle","color","axisLine","axisTick","axisLabel","inside","align","yAxis","min","max","line","length","series","renderItem","renderGanttItem","dimensions","order","formatter","startTime","moment","params","format","endTime","compl_qty","fi","borderColor","borderRadius","encode","x","DIM_TIME_ARRIVAL","DIM_TIME_DEPARTURE","y","DIM_CATEGORY_INDEX","renderAxisLabelItem","echarts","util","map","item","index","concat","api","status","value","dp","findIndex","getColor","highlightColor","utils","categoryIndex","timeArrival","coord","timeDeparture","coordSys","_cartesianXBounds","_cartesianYBounds","barLength","barHeight","size","HEIGHT_RATIO","flightNumber","flightNumberWidth","getTextRect","rectNormal","clipRectByRect","rectVIP","rectText","children","ignore","shape","style","fill","styleEmphasis","stroke","lineWidth","textFill","d","layout","textVerticalAlign","textAlign","rect","graphic","model","_draggable","_myChart","setOption","disabled","setIconStatus","interationSetup","myChart","panelCtrl","_panelCtrl","setListeners","initDrag","refreshPanel","refresh","_autoDataZoomAnimator","makeAnimator","dispatchDataZoom","on","param","seriesIndex","_draggingRecord","dataIndex","cursorPositionX","event","offsetX","lineDash","_draggingEl","addOrUpdateBar","_draggingCursorOffset","offsetY","_draggingTimeLength","getZr","cursorX","cursorY","attr","prepareDrop","autoDataZoomWhenDraggingOutside","_dropRecord","updateRawData","dragRelease","stop","remove","_dropShadow","el","itemData","z","pointArrival","convertToPixel","pointDeparture","Math","abs","Rect","add","xPixel","yPixel","cursorData","convertFromPixel","floor","orderData","movingItem","i","dataItem","dropCtrl","showForm","mergeKeyVal","cursorDistX","getCursorCartesianDist","cursorDistY","optionInsideX","DATA_ZOOM_X_INSIDE_INDEX","optionInsideY","DATA_ZOOM_Y_INSIDE_INDEX","batch","prepareBatch","dispatchAction","cursorDist","sign","delta","DATA_ZOOM_AUTO_MOVE_SPEED","push","dataZoomId","cursorXY","bounds","dist0","DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH","dist1","callback","requestId","callbackParams","throttle","DATA_ZOOM_AUTO_MOVE_THROTTLE","onFrame","requestAnimationFrame","cancelAnimationFrame","off","order_actions","showOrderActions","key"],"mappings":"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","file":"chart_option.js","sourcesContent":["import * as dp from './data_processor'\nimport * as utils from './utils'\nimport * as order_actions from './order_actions_ctrl'\nimport * as dropCtrl from './drop_order_ctrl'\n\nimport echarts from './libs/echarts.min'\nimport moment from 'moment'\n\nlet HEIGHT_RATIO = 0.6;\nlet DIM_CATEGORY_INDEX = 0;\nlet DIM_TIME_ARRIVAL = 1;\nlet DIM_TIME_DEPARTURE = 2;\nlet DATA_ZOOM_AUTO_MOVE_THROTTLE = 30;\nlet DATA_ZOOM_X_INSIDE_INDEX = 1;\nlet DATA_ZOOM_Y_INSIDE_INDEX = 3;\nlet DATA_ZOOM_AUTO_MOVE_SPEED = 0.2;\nlet DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH = 30;\n\nlet _draggable;\nlet _draggingEl;\nlet _dropShadow;\nlet _draggingCursorOffset = [0, 0];\nlet _draggingTimeLength;\nlet _draggingRecord;\nlet _dropRecord;\nlet _cartesianXBounds = [];\nlet _cartesianYBounds = [];\nlet _rawData;\nlet _autoDataZoomAnimator;\n\nlet _myChart\nlet _panelCtrl\n\nexport function getOption (data, ) {\n  \n  _rawData = data  \n  \n  let option = {\n    tooltip: {\n    },\n    animation: false,\n    toolbox: {\n        left: 20,\n        top: 0,\n        itemSize: 20,\n        feature: {\n            myDrag: {\n                show: true,\n                title: 'Make orders\\ndraggable',\n                icon: 'path://M990.55 380.08 q11.69 0 19.88 8.19 q7.02 7.01 7.02 18.71 l0 480.65 q-1.17 43.27 -29.83 71.93 q-28.65 28.65 -71.92 29.82 l-813.96 0 q-43.27 -1.17 -72.5 -30.41 q-28.07 -28.07 -29.24 -71.34 l0 -785.89 q1.17 -43.27 29.24 -72.5 q29.23 -29.24 72.5 -29.24 l522.76 0 q11.7 0 18.71 7.02 q8.19 8.18 8.19 18.71 q0 11.69 -7.6 19.29 q-7.6 7.61 -19.3 7.61 l-518.08 0 q-22.22 1.17 -37.42 16.37 q-15.2 15.2 -15.2 37.42 l0 775.37 q0 23.39 15.2 38.59 q15.2 15.2 37.42 15.2 l804.6 0 q22.22 0 37.43 -15.2 q15.2 -15.2 16.37 -38.59 l0 -474.81 q0 -11.7 7.02 -18.71 q8.18 -8.19 18.71 -8.19 l0 0 ZM493.52 723.91 l-170.74 -170.75 l509.89 -509.89 q23.39 -23.39 56.13 -21.05 q32.75 1.17 59.65 26.9 l47.94 47.95 q25.73 26.89 27.49 59.64 q1.75 32.75 -21.64 57.3 l-508.72 509.9 l0 0 ZM870.09 80.69 l-56.13 56.14 l94.72 95.9 l56.14 -57.31 q8.19 -9.35 8.19 -21.05 q-1.17 -12.86 -10.53 -22.22 l-47.95 -49.12 q-10.52 -9.35 -23.39 -9.35 q-11.69 -1.17 -21.05 7.01 l0 0 ZM867.75 272.49 l-93.56 -95.9 l-380.08 380.08 l94.73 94.73 l378.91 -378.91 l0 0 ZM322.78 553.16 l38.59 39.77 l-33.92 125.13 l125.14 -33.92 l38.59 38.6 l-191.79 52.62 q-5.85 1.17 -12.28 0 q-6.44 -1.17 -11.11 -5.84 q-4.68 -4.68 -5.85 -11.7 q-2.34 -5.85 0 -11.69 l52.63 -192.97 l0 0 Z',\n                onclick: onDragSwitchClick\n            }\n        }\n    },\n    title: {\n        text: '',\n        left: 'center'\n    },\n    dataZoom: [{\n        type: 'slider',\n        xAxisIndex: 0,\n        filterMode: 'weakFilter',\n        height: 20,\n        bottom: 0,\n        start: 0,\n        end: 100,\n        handleIcon: 'M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',\n        handleSize: '80%',\n        showDetail: false\n    }, {\n        type: 'inside',\n        id: 'insideX',\n        xAxisIndex: 0,\n        filterMode: 'weakFilter',\n        start: 0,\n        end: 26,\n        zoomOnMouseWheel: false,\n        moveOnMouseMove: true\n    }, {\n        type: 'slider',\n        yAxisIndex: 0,\n        zoomLock: true,\n        width: 10,\n        right: 10,\n        top: 70,\n        bottom: 20,\n        start: 0,\n        end: 1000,\n        handleSize: 0,\n        showDetail: false,\n    }, {\n        type: 'inside',\n        id: 'insideY',\n        yAxisIndex: 0,\n        start: 95,\n        end: 100,\n        zoomOnMouseWheel: false,\n        moveOnMouseMove: true,\n        moveOnMouseWheel: true\n    }],\n    grid: {\n        show: true,\n        top: 70,\n        bottom: 20,\n        left: 260,\n        right: 20,\n        backgroundColor: '#fff',\n        borderWidth: 0\n    },\n    xAxis: {\n        type: 'time',\n        position: 'top',\n        splitLine: {\n            lineStyle: {\n                color: ['#E9EDFF']\n            }\n        },\n        axisLine: {\n            show: false\n        },\n        axisTick: {\n            lineStyle: {\n                color: '#929ABA'\n            }\n        },\n        axisLabel: {\n            color: '#929ABA',\n            inside: false,\n            align: 'center'\n        }\n    },\n    yAxis: {\n        axisTick: {show: false},\n        splitLine: {show: false},\n        axisLine: {show: false},\n        axisLabel: {show: false},\n        min: 0,\n        max: _rawData.line.data.length\n    },\n    series: [\n      {\n        id: 'flightData',\n        type: 'custom',\n        renderItem: renderGanttItem,\n        dimensions: _rawData.order.dimensions,\n        tooltip: {\n            formatter: params => {\n                // console.log(params);\n                // console.log(_rawData.order.dimensions);\n                \n                const startTime = moment(params.data[1]).format('YYYY-MM-DD H:mm:ss')\n                const endTime = moment(params.data[2]).format('YYYY-MM-DD H:mm:ss')\n                const compl_qty = params.data[fi('compl_qty')] === null ? 0 : params.data[fi('compl_qty')]\n\n                let tooltip = '<p style=\"text-align:center;margin:0px;color:#999\">Order ID : ' + params.data[fi('order_id')] + '</p>'\n                tooltip += '<div style=\"margin:5px 0px 5px 0px; width:100%; height:1px; background: #999\"></div>'\n                if (params.data[fi('status')]  === 'Changeover') {\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Change-Over </strong></p> '\n                }else {\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Planned Qty :</strong> &nbsp;' + params.data[fi('order_qty')] + '</p> '\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Confirmed Qty :</strong> &nbsp;' + compl_qty + '</p> '\n                }\n                tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Start Time :</strong> &nbsp;' + startTime + '</p> '\n                tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">End Time :</strong> &nbsp;' + endTime + '</p> '\n                return tooltip\n            },\n            backgroundColor: '#eee',\n            borderColor: '#aaa',\n            borderWidth: 1,\n            borderRadius: 4,\n        },\n        encode: {\n            x: [DIM_TIME_ARRIVAL, DIM_TIME_DEPARTURE],\n            y: DIM_CATEGORY_INDEX,\n        },\n        data: _rawData.order.data\n      },\n      {\n        type: 'custom',\n        renderItem: renderAxisLabelItem,\n        dimensions: _rawData.line.dimensions,\n        encode: {\n            x: -1, // Then this series will not controlled by x.\n            y: 0\n        },\n        data: echarts.util.map(_rawData.line.data, function (item, index) {\n            return [index].concat(item);\n        })\n      }\n    ]\n  }\n\n  return option\n}\n\nfunction renderGanttItem(params, api) {\n  \n  let status = api.value(dp.findIndex('status', _rawData.order.dimensions))\n  const color = dp.getColor(status)\n  const highlightColor = utils.highlightColor(color)\n  \n  var categoryIndex = api.value(DIM_CATEGORY_INDEX);\n  var timeArrival = api.coord([api.value(DIM_TIME_ARRIVAL), categoryIndex]);\n  var timeDeparture = api.coord([api.value(DIM_TIME_DEPARTURE), categoryIndex]);\n\n  var coordSys = params.coordSys;\n  _cartesianXBounds[0] = coordSys.x;\n  _cartesianXBounds[1] = coordSys.x + coordSys.width;\n  _cartesianYBounds[0] = coordSys.y;\n  _cartesianYBounds[1] = coordSys.y + coordSys.height;\n\n  var barLength = timeDeparture[0] - timeArrival[0];\n  // Get the heigth corresponds to length 1 on y axis.\n  var barHeight = api.size([0, 1])[1] * HEIGHT_RATIO;\n  var x = timeArrival[0];\n  var y = timeArrival[1] - barHeight;\n\n  var flightNumber = status === 'Changeover' ? 'C' : api.value(4) + ''\n  var flightNumberWidth = echarts.format.getTextRect(flightNumber).width;\n  var text = (barLength > flightNumberWidth + 40 && x + barLength >= 180)\n      ? flightNumber : '';\n\n  var rectNormal = clipRectByRect(params, {\n      x: x, y: y, width: barLength, height: barHeight\n  });\n  var rectVIP = clipRectByRect(params, {\n      x: x, y: y, width: (barLength) / 2, height: barHeight\n  });\n  var rectText = clipRectByRect(params, {\n      x: x, y: y, width: barLength, height: barHeight\n  });\n\n  return {\n      type: 'group',\n      children: [{\n          type: 'rect',\n          ignore: !rectNormal,\n          shape: rectNormal,\n          style: api.style({fill: color}),\n          styleEmphasis: {fill: highlightColor}\n      }, \n      {\n          type: 'rect',\n          ignore: !rectVIP && !api.value(4),\n          shape: rectVIP,\n          style: api.style({fill: color}),\n          styleEmphasis: {fill: highlightColor}\n      }, \n      {\n          type: 'rect',\n          ignore: !rectText,\n          shape: rectText,\n          style: api.style({\n              fill: 'transparent',\n              stroke: '#000000',\n              lineWidth: 0.5,\n              text: text,\n              textFill: '#fff'\n          })\n      }]\n  };\n}\n\nfunction renderAxisLabelItem(params, api) {\n  var y = api.coord([0, api.value(0)])[1];\n  if (y < params.coordSys.y + 5) {\n      return;\n  }\n  return {\n      type: 'group',\n      position: [\n          10,\n          y\n      ],\n      children: [{\n          type: 'path',\n          shape: {\n              d: 'M0,0 L0,-20 L30,-20 C42,-20 38,-1 50,-1 L70,-1 L70,0 Z',\n              x: 0,\n              y: -20,\n              width: 250,\n              height: 20,\n              layout: 'cover'\n          },\n          style: {\n              fill: '#368c6c'\n          }\n      }, {\n          type: 'text',\n          style: {\n              x: 54,\n              y: -3,\n              text: api.value(1),\n              textVerticalAlign: 'bottom',\n              textAlign: 'center',\n              textFill: '#fff'\n          }\n      }, {\n          type: 'text',\n          style: {\n              x: 200,\n              y: -2,\n              textVerticalAlign: 'bottom',\n              textAlign: 'center',\n              text: api.value(2),\n              textFill: '#000'\n          }\n      }]\n  };\n}\n\n\nfunction clipRectByRect(params, rect) {\n  return echarts.graphic.clipRectByRect(rect, {\n    x: params.coordSys.x,\n    y: params.coordSys.y,\n    width: params.coordSys.width,\n    height: params.coordSys.height\n  });\n}\n\n\n//--------------------------------------------\n\nfunction onDragSwitchClick(model, api, type) {\n  _draggable = !_draggable;\n  _myChart.setOption({\n      dataZoom: [{\n          id: 'insideX',\n          disabled: _draggable\n      }, {\n          id: 'insideY',\n          disabled: _draggable\n      }]\n  });\n  this.model.setIconStatus(type, _draggable ? 'emphasis' : 'normal');\n}\n\nexport function interationSetup(myChart, panelCtrl){\n  _myChart = myChart\n  _panelCtrl = panelCtrl\n  \n  //set listeners like onclick...\n  setListeners(myChart)\n\n  //init drag function\n  initDrag(myChart)\n}\n\nexport function refreshPanel(){\n  _panelCtrl.refresh()\n}\n\nfunction initDrag(myChart){\n  _autoDataZoomAnimator = makeAnimator(dispatchDataZoom);\n\n  myChart.on('mousedown', function (param) {\n    // console.log(param.event.offsetX);\n    \n    if (!_draggable || !param || param.seriesIndex === null) {\n      return;\n    }\n    // Drag start\n    _draggingRecord = {\n      dataIndex: param.dataIndex,\n      categoryIndex: param.value[DIM_CATEGORY_INDEX],\n      timeArrival: param.value[DIM_TIME_ARRIVAL],\n      timeDeparture: param.value[DIM_TIME_DEPARTURE],\n      cursorPositionX: param.event.offsetX\n    };\n    var style = {lineWidth: 2, fill: 'rgba(255,0,0,0.1)', stroke: 'rgba(255,0,0,0.8)', lineDash: [6, 3]};\n\n    _draggingEl = addOrUpdateBar(_draggingEl, _draggingRecord, style, 100);\n    _draggingCursorOffset = [\n      _draggingEl.position[0] - param.event.offsetX,\n      _draggingEl.position[1] - param.event.offsetY\n    ];\n    _draggingTimeLength = _draggingRecord.timeDeparture - _draggingRecord.timeArrival;\n  });\n\n  myChart.getZr().on('mousemove', function (event) {\n    if (!_draggingEl) {\n      return;\n    }\n\n    var cursorX = event.offsetX;\n    var cursorY = event.offsetY;\n\n    // Move _draggingEl.\n    _draggingEl.attr('position', [\n      _draggingCursorOffset[0] + cursorX,\n      _draggingCursorOffset[1] + cursorY,\n    ]);\n\n    prepareDrop();\n\n    autoDataZoomWhenDraggingOutside(cursorX, cursorY);\n  });\n\n  myChart.getZr().on('mouseup', function () {\n    // Drop\n    if (_draggingEl && _dropRecord) {\n\n      updateRawData() && myChart.setOption({\n        series: {\n          id: 'flightData',\n          data: _rawData.order.data\n        }\n      });\n    }\n    dragRelease();\n  });\n  myChart.getZr().on('globalout', dragRelease);\n\n  function dragRelease() {\n    _autoDataZoomAnimator.stop();\n\n    if (_draggingEl) {\n      myChart.getZr().remove(_draggingEl);\n      _draggingEl = null;\n    }\n    if (_dropShadow) {\n      myChart.getZr().remove(_dropShadow);\n      _dropShadow = null;\n    }\n    _dropRecord = _draggingRecord = null;\n  }\n\n  function addOrUpdateBar(el, itemData, style, z) {\n    var pointArrival = myChart.convertToPixel('grid', [itemData.timeArrival, itemData.categoryIndex]);\n    //set item shadow to be in the cursor's position\n    if (itemData.cursorPositionX) {\n      pointArrival[0] = itemData.cursorPositionX - 10\n    }\n    var pointDeparture = myChart.convertToPixel('grid', [itemData.timeDeparture, itemData.categoryIndex]);\n\n    // var barLength = pointDeparture[0] - pointArrival[0];\n    var barLength = 20\n\n    var barHeight = Math.abs(\n      myChart.convertToPixel('grid', [0, 0])[1] - myChart.convertToPixel('grid', [0, 1])[1]\n    ) * HEIGHT_RATIO;\n\n    if (!el) {\n      el = new echarts.graphic.Rect({\n        shape: {x: 0, y: 0, width: 0, height: 0},\n        style: style,\n        z: z\n      });\n      myChart.getZr().add(el);\n    }\n    el.attr({\n      shape: {x: 0, y: 0, width: barLength, height: barHeight},\n      position: [pointArrival[0], pointArrival[1] - barHeight]\n    });    \n    \n    return el;\n  }\n\n  function prepareDrop() {\n    // Check droppable place.\n    var xPixel = _draggingEl.shape.x + _draggingEl.position[0];\n    var yPixel = _draggingEl.shape.y + _draggingEl.position[1];\n    var cursorData = myChart.convertFromPixel('grid', [xPixel, yPixel]);      \n    \n    if (cursorData) {\n      // Make drop shadow and _dropRecord\n      _dropRecord = {\n        categoryIndex: Math.floor(cursorData[1]),\n        timeArrival: cursorData[0],\n        timeDeparture: cursorData[0] + _draggingTimeLength\n      };\n      var style = {fill: 'rgba(0,0,0,0.4)'};\n      _dropShadow = addOrUpdateBar(_dropShadow, _dropRecord, style, 99);\n    }\n  }\n\n  // This is some business logic, don't care about it.\n  function updateRawData() {\n    const orderData = _rawData.order.data;\n    let movingItem = orderData[_draggingRecord.dataIndex];\n    //If the dragging item is a changeover item, return.\n    if (movingItem[fi('status')] === 'Changeover') { return }\n    \n    // Check if hits anthoer order\n    for (let i = 0; i < orderData.length; i++) {\n      const dataItem = orderData[i];\n      \n      //if the dragging item is overlapped with changeover, return\n      if (dataItem[fi('status')] === 'Changeover') { return }\n      \n      //if hits another order, show form\n      if (dataItem !== movingItem\n        && _dropRecord.categoryIndex === dataItem[DIM_CATEGORY_INDEX]\n        && _dropRecord.timeArrival < dataItem[DIM_TIME_DEPARTURE]\n        && _dropRecord.timeArrival > dataItem[DIM_TIME_ARRIVAL]\n      ) {\n        dropCtrl.showForm(utils.mergeKeyVal(movingItem, _rawData.order.dimensions), utils.mergeKeyVal(dataItem, _rawData.order.dimensions))\n      }\n    }\n\n    return true;\n  }\n\n  function autoDataZoomWhenDraggingOutside(cursorX, cursorY) {\n      // When cursor is outside the cartesian and being dragging,\n      // auto move the dataZooms.\n      var cursorDistX = getCursorCartesianDist(cursorX, _cartesianXBounds);\n      var cursorDistY = getCursorCartesianDist(cursorY, _cartesianYBounds);\n\n      if (cursorDistX !== 0 || cursorDistY !== 0) {\n        _autoDataZoomAnimator.start({\n            cursorDistX: cursorDistX,\n            cursorDistY: cursorDistY\n        });\n      }\n      else {\n        _autoDataZoomAnimator.stop();\n      }\n  }\n\n  function dispatchDataZoom(params) {\n    var option = myChart.getOption();\n    var optionInsideX = option.dataZoom[DATA_ZOOM_X_INSIDE_INDEX];\n    var optionInsideY = option.dataZoom[DATA_ZOOM_Y_INSIDE_INDEX];\n    var batch = [];\n\n    prepareBatch(batch, 'insideX', optionInsideX.start, optionInsideX.end, params.cursorDistX);\n    prepareBatch(batch, 'insideY', optionInsideY.start, optionInsideY.end, -params.cursorDistY);\n\n    batch.length && myChart.dispatchAction({\n      type: 'dataZoom',\n      batch: batch\n    });\n\n    function prepareBatch(batch, id, start, end, cursorDist) {\n      if (cursorDist === 0) {\n          return;\n      }\n      var sign = cursorDist / Math.abs(cursorDist);\n      var size = end - start;\n      var delta = DATA_ZOOM_AUTO_MOVE_SPEED * sign;\n\n      start += delta;\n      end += delta;\n\n      if (end > 100) {\n          end = 100;\n          start = end - size;\n      }\n      if (start < 0) {\n          start = 0;\n          end = start + size;\n      }\n      batch.push({\n          dataZoomId: id,\n          start: start,\n          end: end\n      });\n    }\n  }\n\n  function getCursorCartesianDist(cursorXY, bounds) {\n    var dist0 = cursorXY - (bounds[0] + DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH);\n    var dist1 = cursorXY - (bounds[1] - DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH);\n    return dist0 * dist1 <= 0\n        ? 0 // cursor is in cartesian\n        : dist0 < 0\n        ? dist0 // cursor is at left/top of cartesian\n        : dist1; // cursor is at right/bottom of cartesian\n  }\n\n  function makeAnimator(callback) {\n    var requestId;\n    var callbackParams;\n    // Use throttle to prevent from calling dispatchAction frequently.\n    callback = echarts.throttle(callback, DATA_ZOOM_AUTO_MOVE_THROTTLE);\n\n    function onFrame() {\n        callback(callbackParams);\n        requestId = requestAnimationFrame(onFrame);\n    }\n\n    return {\n        start: function (params) {\n            callbackParams = params;\n            if (requestId == null) {\n                onFrame();\n            }\n        },\n        stop: function () {\n            if (requestId != null) {\n                cancelAnimationFrame(requestId);\n            }\n            requestId = callbackParams = null;\n        }\n    };\n  }\n}\n\n\n\nfunction setListeners(myChart){\n  myChart.off('click')\n  myChart.on('click', params => {\n    if (!_draggable) {\n      if (params.data[fi('status')] !== 'Changeover') {\n        order_actions.showOrderActions(utils.mergeKeyVal(params.data, _rawData.order.dimensions))\n      }\n    }\n  })\n}\n\n/**\n * Find the index that match the key in the order dimensions array\n * @param {*} key \n */\nfunction fi(key){\n  return dp.findIndex(key, _rawData.order.dimensions)\n}\n"]}