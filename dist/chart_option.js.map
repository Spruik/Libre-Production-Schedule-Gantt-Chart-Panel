{"version":3,"sources":["../src/chart_option.js"],"names":["getOption","data","_rawData","option","tooltip","animation","toolbox","left","top","itemSize","feature","myDrag","show","title","icon","onclick","onDragSwitchClick","text","dataZoom","type","xAxisIndex","filterMode","height","bottom","start","_bottomSliderDataZoomStart","end","_bottomSliderDataZoomEnd","handleIcon","handleSize","showDetail","handleStyle","shadowBlur","shadowOffsetX","shadowOffsetY","shadowColor","id","zoomOnMouseWheel","moveOnMouseMove","yAxisIndex","zoomLock","width","right","moveOnMouseWheel","grid","backgroundColor","borderWidth","xAxis","position","splitLine","lineStyle","color","axisLine","axisTick","axisLabel","inside","align","yAxis","min","max","line","length","series","renderItem","renderGanttItem","dimensions","order","formatter","startTime","moment","params","format","endTime","compl_qty","fi","cons","STATE_CHANGEOVER","STATE_START","STATE_PAUSE","STATE_COMPLETE","STATE_CLOSE","borderColor","borderRadius","encode","x","DIM_TIME_ARRIVAL","DIM_TIME_DEPARTURE","y","DIM_CATEGORY_INDEX","renderAxisLabelItem","echarts","util","map","item","index","concat","api","status","value","dp","findIndex","pId","getColor","highlightColor","utils","categoryIndex","timeArrival","coord","timeDeparture","coordSys","_cartesianXBounds","_cartesianYBounds","barLength","barHeight","size","HEIGHT_RATIO","flightNumber","replace","flightNumberWidth","getTextRect","rectNormal","clipRectByRect","rectVIP","rectText","children","ignore","shape","style","fill","styleEmphasis","stroke","lineWidth","textFill","d","layout","textVerticalAlign","textAlign","rect","graphic","model","_draggable","_myChart","setOption","disabled","setIconStatus","interationSetup","myChart","panelCtrl","_panelCtrl","setListeners","initDrag","refreshDashboard","timeSrv","_autoDataZoomAnimator","makeAnimator","dispatchDataZoom","on","param","seriesIndex","_draggingRecord","dataIndex","cursorPositionX","event","offsetX","lineDash","_draggingEl","addOrUpdateBar","_draggingCursorOffset","offsetY","_draggingTimeLength","getZr","cursorX","cursorY","attr","prepareDrop","autoDataZoomWhenDraggingOutside","_dropRecord","updateRawData","dragRelease","stop","remove","_dropShadow","el","itemData","z","pointArrival","convertToPixel","pointDeparture","Math","abs","Rect","add","xPixel","yPixel","cursorData","convertFromPixel","floor","orderData","movingItem","STATE_PLAN","STATE_READY","i","dataItem","dropCtrl","showForm","mergeKeyVal","cursorDistX","getCursorCartesianDist","cursorDistY","optionInsideX","DATA_ZOOM_X_INSIDE_INDEX","optionInsideY","DATA_ZOOM_Y_INSIDE_INDEX","batch","prepareBatch","dispatchAction","cursorDist","sign","delta","DATA_ZOOM_AUTO_MOVE_SPEED","push","dataZoomId","cursorXY","bounds","dist0","DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH","dist1","callback","requestId","callbackParams","throttle","DATA_ZOOM_AUTO_MOVE_THROTTLE","onFrame","requestAnimationFrame","cancelAnimationFrame","off","order_actions","showOrderActions","localeCompare","key"],"mappings":";;;;;;;AAqCO,WAASA,SAAT,CAAoBC,IAApB,EAA4B;;AAEjCC,eAAWD,IAAX;;AAEA,QAAIE,SAAS;AACXC,eAAS,EADE;AAGXC,iBAAW,KAHA;AAIXC,eAAS;AACLC,cAAM,EADD;AAELC,aAAK,CAFA;AAGLC,kBAAU,EAHL;AAILC,iBAAS;AACLC,kBAAQ;AACJC,kBAAM,IADF;AAEJC,mBAAO,wBAFH;AAGJC,kBAAM,ssCAHF;AAIJC,qBAASC;AAJL;AADH;AAJJ,OAJE;AAiBXH,aAAO;AACHI,cAAM,EADH;AAEHV,cAAM;AAFH,OAjBI;AAqBXW,gBAAU,CAAC;AACTC,cAAM,QADG;AAETC,oBAAY,CAFH;AAGTC,oBAAY,YAHH;AAITC,gBAAQ,EAJC;AAKTC,gBAAQ,CALC;AAMTC,eAAOC,8BAA8B,CAN5B;AAOTC,aAAKC,4BAA4B,GAPxB;AAQTC,oBAAY,kLARH;AASTC,oBAAY,EATH;AAUTC,oBAAY,KAVH;AAWTC,qBAAa;AACTC,sBAAY,CADH;AAETC,yBAAe,CAFN;AAGTC,yBAAe,CAHN;AAITC,uBAAa;AAJJ;AAXJ,OAAD,EAiBP;AACChB,cAAM,QADP;AAECiB,YAAI,SAFL;AAGChB,oBAAY,CAHb;AAICC,oBAAY,YAJb;AAKCG,eAAO,CALR;AAMCE,aAAK,EANN;AAOCW,0BAAkB,KAPnB;AAQCC,yBAAiB;AARlB,OAjBO,EA0BP;AACCnB,cAAM,QADP;AAECoB,oBAAY,CAFb;AAGCC,kBAAU,IAHX;AAICC,eAAO,EAJR;AAKCC,eAAO,EALR;AAMClC,aAAK,EANN;AAOCe,gBAAQ,EAPT;AAQCC,eAAO,CARR;AASCE,aAAK,GATN;AAUCG,oBAAY,CAVb;AAWCC,oBAAY;AAXb,OA1BO,EAsCP;AACCX,cAAM,QADP;AAECiB,YAAI,SAFL;AAGCG,oBAAY,CAHb;AAICf,eAAO,CAJR;AAKCE,aAAK,GALN;AAMCW,0BAAkB,KANnB;AAOCC,yBAAiB,IAPlB;AAQCK,0BAAkB;AARnB,OAtCO,CArBC;AAqEXC,YAAM;AACFhC,cAAM,IADJ;AAEFJ,aAAK,EAFH;AAGFe,gBAAQ,EAHN;AAIFhB,cAAM,GAJJ;AAKFmC,eAAO,EALL;AAMFG,yBAAiB,MANf;AAOFC,qBAAa;AAPX,OArEK;AA8EXC,aAAO;AACH5B,cAAM,MADH;AAEH6B,kBAAU,KAFP;AAGHC,mBAAW;AACPC,qBAAW;AACPC,mBAAO,CAAC,SAAD;AADA;AADJ,SAHR;AAQHC,kBAAU;AACNxC,gBAAM;AADA,SARP;AAWHyC,kBAAU;AACNH,qBAAW;AACPC,mBAAO;AADA;AADL,SAXP;AAgBHG,mBAAW;AACPH,iBAAO,SADA;AAEPI,kBAAQ,KAFD;AAGPC,iBAAO;AAHA;AAhBR,OA9EI;AAoGXC,aAAO;AACHJ,kBAAU,EAACzC,MAAM,KAAP,EADP;AAEHqC,mBAAW,EAACrC,MAAM,KAAP,EAFR;AAGHwC,kBAAU,EAACxC,MAAM,KAAP,EAHP;AAIH0C,mBAAW,EAAC1C,MAAM,KAAP,EAJR;AAKH8C,aAAK,CALF;AAMHC,aAAKzD,SAAS0D,IAAT,CAAc3D,IAAd,CAAmB4D;AANrB,OApGI;AA4GXC,cAAQ,CACN;AACE1B,YAAI,YADN;AAEEjB,cAAM,QAFR;AAGE4C,oBAAYC,eAHd;AAIEC,oBAAY/D,SAASgE,KAAT,CAAeD,UAJ7B;AAKE7D,iBAAS;AACL+D,qBAAW,2BAAU;AACjB,gBAAMC,YAAYC,OAAOC,OAAOrE,IAAP,CAAY,CAAZ,CAAP,EAAuBsE,MAAvB,CAA8B,oBAA9B,CAAlB;AACA,gBAAMC,UAAUH,OAAOC,OAAOrE,IAAP,CAAY,CAAZ,CAAP,EAAuBsE,MAAvB,CAA8B,oBAA9B,CAAhB;AACA,gBAAME,YAAYH,OAAOrE,IAAP,CAAYyE,GAAG,WAAH,CAAZ,MAAiC,IAAjC,GAAwC,CAAxC,GAA4CJ,OAAOrE,IAAP,CAAYyE,GAAG,WAAH,CAAZ,CAA9D;;AAEA,gBAAItE,UAAU,mEAAmEkE,OAAOrE,IAAP,CAAYyE,GAAG,UAAH,CAAZ,CAAnE,GAAiG,MAA/G;AACAtE,uBAAW,sFAAX;AACA,gBAAIkE,OAAOrE,IAAP,CAAYyE,GAAG,QAAH,CAAZ,MAA+BC,KAAKC,gBAAxC,EAA0D;AACxDxE,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,+DAA1D;AACD,aAFD,MAEM;AACJ/C,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,iEAA/C,GAAmHmB,OAAOrE,IAAP,CAAYyE,GAAG,YAAH,CAAZ,CAAnH,GAAmJ,OAA9J;AACAtE,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,mEAA/C,GAAqHmB,OAAOrE,IAAP,CAAYyE,GAAG,cAAH,CAAZ,CAArH,GAAuJ,OAAlK;AACAtE,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,kEAA/C,GAAoHmB,OAAOrE,IAAP,CAAYyE,GAAG,WAAH,CAAZ,CAApH,GAAmJ,OAA9J;AACAtE,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,oEAA/C,GAAsHsB,SAAtH,GAAkI,OAA7I;AACD;AACDrE,uBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,2EAA/C,GAA6HiB,SAA7H,GAAyI,OAApJ;AACAhE,uBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,yEAA/C,GAA2HqB,OAA3H,GAAqI,OAAhJ;AACA,gBAAIF,OAAOrE,IAAP,CAAYyE,GAAG,QAAH,CAAZ,MAA+BC,KAAKE,WAApC,IAAmDP,OAAOrE,IAAP,CAAYyE,GAAG,QAAH,CAAZ,MAA+BC,KAAKG,WAA3F,EAAwG;AACtG1E,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,wEAA/C,GAA0HkB,OAAOC,OAAOrE,IAAP,CAAYyE,GAAG,uBAAH,CAAZ,CAAP,EAAiDH,MAAjD,CAAwD,oBAAxD,CAA1H,GAA0M,OAArN;AACD;AACD,gBAAID,OAAOrE,IAAP,CAAYyE,GAAG,QAAH,CAAZ,MAA+BC,KAAKI,cAApC,IAAsDT,OAAOrE,IAAP,CAAYyE,GAAG,QAAH,CAAZ,MAA+BC,KAAKK,WAA9F,EAA2G;AACzG5E,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,wEAA/C,GAA0HkB,OAAOC,OAAOrE,IAAP,CAAYyE,GAAG,uBAAH,CAAZ,CAAP,EAAiDH,MAAjD,CAAwD,oBAAxD,CAA1H,GAA0M,OAArN;AACAnE,yBAAW,gCAAgCkE,OAAOnB,KAAvC,GAA+C,sEAA/C,GAAwHkB,OAAOC,OAAOrE,IAAP,CAAYyE,GAAG,qBAAH,CAAZ,CAAP,EAA+CH,MAA/C,CAAsD,oBAAtD,CAAxH,GAAsM,OAAjN;AACD;AACD,mBAAOnE,OAAP;AACH,WA1BI;AA2BLyC,2BAAiB,MA3BZ;AA4BLoC,uBAAa,MA5BR;AA6BLnC,uBAAa,CA7BR;AA8BLoC,wBAAc;AA9BT,SALX;AAqCEC,gBAAQ;AACJC,aAAG,CAACC,gBAAD,EAAmBC,kBAAnB,CADC;AAEJC,aAAGC;AAFC,SArCV;AAyCEvF,cAAMC,SAASgE,KAAT,CAAejE;AAzCvB,OADM,EA4CN;AACEkB,cAAM,QADR;AAEE4C,oBAAY0B,mBAFd;AAGExB,oBAAY/D,SAAS0D,IAAT,CAAcK,UAH5B;AAIEkB,gBAAQ;AACJC,aAAG,CAAC,CADA,EACG;AACPG,aAAG;AAFC,SAJV;AAQEtF,cAAMyF,QAAQC,IAAR,CAAaC,GAAb,CAAiB1F,SAAS0D,IAAT,CAAc3D,IAA/B,EAAqC,UAAU4F,IAAV,EAAgBC,KAAhB,EAAuB;AAC9D,iBAAO,CAACA,KAAD,EAAQC,MAAR,CAAeF,IAAf,CAAP;AACH,SAFK;AARR,OA5CM;AA5GG,KAAb;;AAuKA,WAAO1F,MAAP;AACD;;uBA5KeH,S;;AA8KhB,WAASgE,eAAT,CAAyBM,MAAzB,EAAiC0B,GAAjC,EAAsC;;AAEpC,QAAMC,SAASD,IAAIE,KAAJ,CAAUC,GAAGC,SAAH,CAAa,QAAb,EAAuBlG,SAASgE,KAAT,CAAeD,UAAtC,CAAV,CAAf;AACA,QAAMoC,MAAML,IAAIE,KAAJ,CAAUC,GAAGC,SAAH,CAAa,gBAAb,EAA+BlG,SAASgE,KAAT,CAAeD,UAA9C,CAAV,CAAZ;AACA,QAAMd,QAAQgD,GAAGG,QAAH,CAAYL,MAAZ,CAAd;AACA,QAAMM,iBAAiBC,MAAMD,cAAN,CAAqBpD,KAArB,CAAvB;;AAEA,QAAIsD,gBAAgBT,IAAIE,KAAJ,CAAUV,kBAAV,CAApB;AACA,QAAIkB,cAAcV,IAAIW,KAAJ,CAAU,CAACX,IAAIE,KAAJ,CAAUb,gBAAV,CAAD,EAA8BoB,aAA9B,CAAV,CAAlB;AACA,QAAIG,gBAAgBZ,IAAIW,KAAJ,CAAU,CAACX,IAAIE,KAAJ,CAAUZ,kBAAV,CAAD,EAAgCmB,aAAhC,CAAV,CAApB;;AAEA,QAAII,WAAWvC,OAAOuC,QAAtB;AACAC,sBAAkB,CAAlB,IAAuBD,SAASzB,CAAhC;AACA0B,sBAAkB,CAAlB,IAAuBD,SAASzB,CAAT,GAAayB,SAASpE,KAA7C;AACAsE,sBAAkB,CAAlB,IAAuBF,SAAStB,CAAhC;AACAwB,sBAAkB,CAAlB,IAAuBF,SAAStB,CAAT,GAAasB,SAASvF,MAA7C;;AAEA,QAAI0F,YAAYJ,cAAc,CAAd,IAAmBF,YAAY,CAAZ,CAAnC;AACA;AACA,QAAIO,YAAYjB,IAAIkB,IAAJ,CAAS,CAAC,CAAD,EAAI,CAAJ,CAAT,EAAiB,CAAjB,IAAsBC,YAAtC;AACA,QAAI/B,IAAIsB,YAAY,CAAZ,CAAR;AACA,QAAInB,IAAImB,YAAY,CAAZ,IAAiBO,SAAzB;;AAEA,QAAIG,eAAenB,WAAWtB,KAAKC,gBAAhB,GAAmC,GAAnC,GAAyCoB,IAAIE,KAAJ,CAAU,CAAV,IAAe,KAAf,GAAuBG,IAAIgB,OAAJ,CAAY,KAAZ,EAAmB,EAAnB,CAAvB,GAAgD,EAA5G;AACA,QAAIC,oBAAoB5B,QAAQnB,MAAR,CAAegD,WAAf,CAA2BH,YAA3B,EAAyC3E,KAAjE;AACA,QAAIxB,OAAQ+F,YAAYM,oBAAoB,EAAhC,IAAsClC,IAAI4B,SAAJ,IAAiB,GAAxD,GACLI,YADK,GACU,EADrB;;AAGA,QAAII,aAAaC,eAAenD,MAAf,EAAuB;AACpCc,SAAGA,CADiC,EAC9BG,GAAGA,CAD2B,EACxB9C,OAAOuE,SADiB,EACN1F,QAAQ2F;AADF,KAAvB,CAAjB;AAGA,QAAIS,UAAUD,eAAenD,MAAf,EAAuB;AACjCc,SAAGA,CAD8B,EAC3BG,GAAGA,CADwB,EACrB9C,OAAQuE,SAAD,GAAc,CADA,EACG1F,QAAQ2F;AADX,KAAvB,CAAd;AAGA,QAAIU,WAAWF,eAAenD,MAAf,EAAuB;AAClCc,SAAGA,CAD+B,EAC5BG,GAAGA,CADyB,EACtB9C,OAAOuE,SADe,EACJ1F,QAAQ2F;AADJ,KAAvB,CAAf;;AAIA,WAAO;AACH9F,YAAM,OADH;AAEHyG,gBAAU,CAAC;AACPzG,cAAM,MADC;AAEP0G,gBAAQ,CAACL,UAFF;AAGPM,eAAON,UAHA;AAIPO,eAAO/B,IAAI+B,KAAJ,CAAU,EAACC,MAAM7E,KAAP,EAAV,CAJA;AAKP8E,uBAAe,EAACD,MAAMzB,cAAP;AALR,OAAD,EAOV;AACIpF,cAAM,MADV;AAEI0G,gBAAQ,CAACH,OAAD,IAAY,CAAC1B,IAAIE,KAAJ,CAAU,CAAV,CAFzB;AAGI4B,eAAOJ,OAHX;AAIIK,eAAO/B,IAAI+B,KAAJ,CAAU,EAACC,MAAM7E,KAAP,EAAV,CAJX;AAKI8E,uBAAe,EAACD,MAAMzB,cAAP;AALnB,OAPU,EAcV;AACIpF,cAAM,MADV;AAEI0G,gBAAQ,CAACF,QAFb;AAGIG,eAAOH,QAHX;AAIII,eAAO/B,IAAI+B,KAAJ,CAAU;AACbC,gBAAM,aADO;AAEbE,kBAAQ,SAFK;AAGbC,qBAAW,GAHE;AAIblH,gBAAMA,IAJO;AAKbmH,oBAAU;AALG,SAAV;AAJX,OAdU;AAFP,KAAP;AA6BD;;AAED,WAAS3C,mBAAT,CAA6BnB,MAA7B,EAAqC0B,GAArC,EAA0C;AACxC,QAAIT,IAAIS,IAAIW,KAAJ,CAAU,CAAC,CAAD,EAAIX,IAAIE,KAAJ,CAAU,CAAV,CAAJ,CAAV,EAA6B,CAA7B,CAAR;AACA,QAAIX,IAAIjB,OAAOuC,QAAP,CAAgBtB,CAAhB,GAAoB,CAA5B,EAA+B;AAC3B;AACH;AACD,WAAO;AACHpE,YAAM,OADH;AAEH6B,gBAAU,CACN,EADM,EAENuC,CAFM,CAFP;AAMHqC,gBAAU,CAAC;AACPzG,cAAM,MADC;AAEP2G,eAAO;AACHO,aAAG,wDADA;AAEHjD,aAAG,CAFA;AAGHG,aAAG,CAAC,EAHD;AAIH9C,iBAAO,GAJJ;AAKHnB,kBAAQ,EALL;AAMHgH,kBAAQ;AANL,SAFA;AAUPP,eAAO;AACHC,gBAAM;AADH;AAVA,OAAD,EAaP;AACC7G,cAAM,MADP;AAEC4G,eAAO;AACH3C,aAAG,EADA;AAEHG,aAAG,CAAC,CAFD;AAGHtE,gBAAM+E,IAAIE,KAAJ,CAAU,CAAV,CAHH;AAIHqC,6BAAmB,QAJhB;AAKHC,qBAAW,QALR;AAMHJ,oBAAU;AANP;AAFR,OAbO,EAuBP;AACCjH,cAAM,MADP;AAEC4G,eAAO;AACH3C,aAAG,GADA;AAEHG,aAAG,CAAC,CAFD;AAGHgD,6BAAmB,QAHhB;AAIHC,qBAAW,QAJR;AAKHvH,gBAAM+E,IAAIE,KAAJ,CAAU,CAAV,CALH;AAMHkC,oBAAU;AANP;AAFR,OAvBO;AANP,KAAP;AAyCD;;AAGD,WAASX,cAAT,CAAwBnD,MAAxB,EAAgCmE,IAAhC,EAAsC;AACpC,WAAO/C,QAAQgD,OAAR,CAAgBjB,cAAhB,CAA+BgB,IAA/B,EAAqC;AAC1CrD,SAAGd,OAAOuC,QAAP,CAAgBzB,CADuB;AAE1CG,SAAGjB,OAAOuC,QAAP,CAAgBtB,CAFuB;AAG1C9C,aAAO6B,OAAOuC,QAAP,CAAgBpE,KAHmB;AAI1CnB,cAAQgD,OAAOuC,QAAP,CAAgBvF;AAJkB,KAArC,CAAP;AAMD;;AAGD;;AAEA,WAASN,iBAAT,CAA2B2H,KAA3B,EAAkC3C,GAAlC,EAAuC7E,IAAvC,EAA6C;AAC3CyH,iBAAa,CAACA,UAAd;AACAC,aAASC,SAAT,CAAmB;AACf5H,gBAAU,CAAC;AACPkB,YAAI,SADG;AAEP2G,kBAAUH;AAFH,OAAD,EAGP;AACCxG,YAAI,SADL;AAEC2G,kBAAUH;AAFX,OAHO;AADK,KAAnB;AASA,SAAKD,KAAL,CAAWK,aAAX,CAAyB7H,IAAzB,EAA+ByH,aAAa,UAAb,GAA0B,QAAzD;AACD;;AAEM,WAASK,eAAT,CAAyBC,OAAzB,EAAkCC,SAAlC,EAA4C;AACjDN,eAAWK,OAAX;AACAE,iBAAaD,SAAb;;AAEA;AACAE,iBAAaH,OAAb;;AAEA;AACAI,aAASJ,OAAT;AACD;;6BATeD,e;;AAWT,WAASM,gBAAT,GAA2B;AAChCH,eAAWI,OAAX,CAAmBD,gBAAnB;AACD;;8BAFeA,gB;;AAIhB,WAASD,QAAT,CAAkBJ,OAAlB,EAA0B;AACxBO,4BAAwBC,aAAaC,gBAAb,CAAxB;AACAT,YAAQU,EAAR,CAAW,WAAX,EAAwB,UAAUC,KAAV,EAAiB;AACvC;AACA,UAAI,CAACjB,UAAD,IAAe,CAACiB,KAAhB,IAAyBA,MAAMC,WAAN,KAAsB,IAAnD,EAAyD;AACvD;AACD;AACD;AACAC,wBAAkB;AAChBC,mBAAWH,MAAMG,SADD;AAEhBvD,uBAAeoD,MAAM3D,KAAN,CAAYV,kBAAZ,CAFC;AAGhBkB,qBAAamD,MAAM3D,KAAN,CAAYb,gBAAZ,CAHG;AAIhBuB,uBAAeiD,MAAM3D,KAAN,CAAYZ,kBAAZ,CAJC;AAKhB2E,yBAAiBJ,MAAMK,KAAN,CAAYC;AALb,OAAlB;AAOA,UAAIpC,QAAQ,EAACI,WAAW,CAAZ,EAAeH,MAAM,mBAArB,EAA0CE,QAAQ,mBAAlD,EAAuEkC,UAAU,CAAC,CAAD,EAAI,CAAJ,CAAjF,EAAZ;;AAEAC,oBAAcC,eAAeD,WAAf,EAA4BN,eAA5B,EAA6ChC,KAA7C,EAAoD,GAApD,CAAd;AACAwC,8BAAwB,CACtBF,YAAYrH,QAAZ,CAAqB,CAArB,IAA0B6G,MAAMK,KAAN,CAAYC,OADhB,EAEtBE,YAAYrH,QAAZ,CAAqB,CAArB,IAA0B6G,MAAMK,KAAN,CAAYM,OAFhB,CAAxB;AAIAC,4BAAsBV,gBAAgBnD,aAAhB,GAAgCmD,gBAAgBrD,WAAtE;AACD,KArBD;;AAuBAwC,YAAQwB,KAAR,GAAgBd,EAAhB,CAAmB,WAAnB,EAAgC,UAAUM,KAAV,EAAiB;AAC/C,UAAI,CAACG,WAAL,EAAkB;AAChB;AACD;;AAED,UAAIM,UAAUT,MAAMC,OAApB;AACA,UAAIS,UAAUV,MAAMM,OAApB;;AAEA;AACAH,kBAAYQ,IAAZ,CAAiB,UAAjB,EAA6B,CAC3BN,sBAAsB,CAAtB,IAA2BI,OADA,EAE3BJ,sBAAsB,CAAtB,IAA2BK,OAFA,CAA7B;;AAKAE;;AAEAC,sCAAgCJ,OAAhC,EAAyCC,OAAzC;AACD,KAjBD;;AAmBA1B,YAAQwB,KAAR,GAAgBd,EAAhB,CAAmB,SAAnB,EAA8B,YAAY;AACxC;AACA,UAAIS,eAAeW,WAAnB,EAAgC;;AAE9BC,2BAAmB/B,QAAQJ,SAAR,CAAkB;AACnChF,kBAAQ;AACN1B,gBAAI,YADE;AAENnC,kBAAMC,SAASgE,KAAT,CAAejE;AAFf;AAD2B,SAAlB,CAAnB;AAMD;AACDiL;AACD,KAZD;AAaAhC,YAAQwB,KAAR,GAAgBd,EAAhB,CAAmB,WAAnB,EAAgCsB,WAAhC;;AAEA,aAASA,WAAT,GAAuB;AACrBzB,4BAAsB0B,IAAtB;;AAEA,UAAId,WAAJ,EAAiB;AACfnB,gBAAQwB,KAAR,GAAgBU,MAAhB,CAAuBf,WAAvB;AACAA,sBAAc,IAAd;AACD;AACD,UAAIgB,WAAJ,EAAiB;AACfnC,gBAAQwB,KAAR,GAAgBU,MAAhB,CAAuBC,WAAvB;AACAA,sBAAc,IAAd;AACD;AACDL,oBAAcjB,kBAAkB,IAAhC;AACD;;AAED,aAASO,cAAT,CAAwBgB,EAAxB,EAA4BC,QAA5B,EAAsCxD,KAAtC,EAA6CyD,CAA7C,EAAgD;AAC9C,UAAIC,eAAevC,QAAQwC,cAAR,CAAuB,MAAvB,EAA+B,CAACH,SAAS7E,WAAV,EAAuB6E,SAAS9E,aAAhC,CAA/B,CAAnB;AACA;AACA,UAAI8E,SAAStB,eAAb,EAA8B;AAC5BwB,qBAAa,CAAb,IAAkBF,SAAStB,eAAT,GAA2B,EAA7C;AACD;AACD,UAAI0B,iBAAiBzC,QAAQwC,cAAR,CAAuB,MAAvB,EAA+B,CAACH,SAAS3E,aAAV,EAAyB2E,SAAS9E,aAAlC,CAA/B,CAArB;;AAEA;AACA,UAAIO,YAAY,EAAhB;;AAEA,UAAIC,YAAY2E,KAAKC,GAAL,CACd3C,QAAQwC,cAAR,CAAuB,MAAvB,EAA+B,CAAC,CAAD,EAAI,CAAJ,CAA/B,EAAuC,CAAvC,IAA4CxC,QAAQwC,cAAR,CAAuB,MAAvB,EAA+B,CAAC,CAAD,EAAI,CAAJ,CAA/B,EAAuC,CAAvC,CAD9B,IAEZvE,YAFJ;;AAIA,UAAI,CAACmE,EAAL,EAAS;AACPA,aAAK,IAAI5F,QAAQgD,OAAR,CAAgBoD,IAApB,CAAyB;AAC5BhE,iBAAO,EAAC1C,GAAG,CAAJ,EAAOG,GAAG,CAAV,EAAa9C,OAAO,CAApB,EAAuBnB,QAAQ,CAA/B,EADqB;AAE5ByG,iBAAOA,KAFqB;AAG5ByD,aAAGA;AAHyB,SAAzB,CAAL;AAKAtC,gBAAQwB,KAAR,GAAgBqB,GAAhB,CAAoBT,EAApB;AACD;AACDA,SAAGT,IAAH,CAAQ;AACN/C,eAAO,EAAC1C,GAAG,CAAJ,EAAOG,GAAG,CAAV,EAAa9C,OAAOuE,SAApB,EAA+B1F,QAAQ2F,SAAvC,EADD;AAENjE,kBAAU,CAACyI,aAAa,CAAb,CAAD,EAAkBA,aAAa,CAAb,IAAkBxE,SAApC;AAFJ,OAAR;;AAKA,aAAOqE,EAAP;AACD;;AAED,aAASR,WAAT,GAAuB;AACrB;AACA,UAAIkB,SAAS3B,YAAYvC,KAAZ,CAAkB1C,CAAlB,GAAsBiF,YAAYrH,QAAZ,CAAqB,CAArB,CAAnC;AACA,UAAIiJ,SAAS5B,YAAYvC,KAAZ,CAAkBvC,CAAlB,GAAsB8E,YAAYrH,QAAZ,CAAqB,CAArB,CAAnC;AACA,UAAIkJ,aAAahD,QAAQiD,gBAAR,CAAyB,MAAzB,EAAiC,CAACH,MAAD,EAASC,MAAT,CAAjC,CAAjB;;AAEA,UAAIC,UAAJ,EAAgB;AACd;AACAlB,sBAAc;AACZvE,yBAAemF,KAAKQ,KAAL,CAAWF,WAAW,CAAX,CAAX,CADH;AAEZxF,uBAAawF,WAAW,CAAX,CAFD;AAGZtF,yBAAesF,WAAW,CAAX,IAAgBzB;AAHnB,SAAd;AAKA,YAAI1C,QAAQ,EAACC,MAAM,iBAAP,EAAZ;AACAqD,sBAAcf,eAAee,WAAf,EAA4BL,WAA5B,EAAyCjD,KAAzC,EAAgD,EAAhD,CAAd;AACD;AACF;;AAED;AACA,aAASkD,aAAT,GAAyB;AACvB,UAAMoB,YAAYnM,SAASgE,KAAT,CAAejE,IAAjC;AACA,UAAIqM,aAAaD,UAAUtC,gBAAgBC,SAA1B,CAAjB;AACA;AACA,UAAIsC,WAAW5H,GAAG,QAAH,CAAX,MAA6BC,KAAK4H,UAAlC,IAAgDD,WAAW5H,GAAG,QAAH,CAAX,MAA6BC,KAAK6H,WAAtF,EAAmG;AAAE;AAAQ;;AAE7G;AACA,WAAK,IAAIC,IAAI,CAAb,EAAgBA,IAAIJ,UAAUxI,MAA9B,EAAsC4I,GAAtC,EAA2C;AACzC,YAAMC,WAAWL,UAAUI,CAAV,CAAjB;;AAEA;AACA,YAAIC,SAAShI,GAAG,QAAH,CAAT,MAA2BC,KAAKC,gBAApC,EAAsD;AAAE;AAAQ;;AAEhE;AACA,YAAI8H,aAAaJ,UAAb,IACCtB,YAAYvE,aAAZ,KAA8BiG,SAASlH,kBAAT,CAD/B,IAECwF,YAAYtE,WAAZ,GAA0BgG,SAASpH,kBAAT,CAF3B,IAGC0F,YAAYtE,WAAZ,GAA0BgG,SAASrH,gBAAT,CAH/B,EAIE;AACAsH,mBAASC,QAAT,CAAkBpG,MAAMqG,WAAN,CAAkBP,UAAlB,EAA8BpM,SAASgE,KAAT,CAAeD,UAA7C,CAAlB,EAA4EuC,MAAMqG,WAAN,CAAkBH,QAAlB,EAA4BxM,SAASgE,KAAT,CAAeD,UAA3C,CAA5E;AACD;AACF;;AAED,aAAO,IAAP;AACD;;AAED,aAAS8G,+BAAT,CAAyCJ,OAAzC,EAAkDC,OAAlD,EAA2D;AACvD;AACA;AACA,UAAIkC,cAAcC,uBAAuBpC,OAAvB,EAAgC7D,iBAAhC,CAAlB;AACA,UAAIkG,cAAcD,uBAAuBnC,OAAvB,EAAgC7D,iBAAhC,CAAlB;;AAEA,UAAI+F,gBAAgB,CAAhB,IAAqBE,gBAAgB,CAAzC,EAA4C;AAC1CvD,8BAAsBjI,KAAtB,CAA4B;AACxBsL,uBAAaA,WADW;AAExBE,uBAAaA;AAFW,SAA5B;AAID,OALD,MAMK;AACHvD,8BAAsB0B,IAAtB;AACD;AACJ;;AAED,aAASxB,gBAAT,CAA0BrF,MAA1B,EAAkC;AAChC,UAAInE,SAAS+I,QAAQlJ,SAAR,EAAb;AACA,UAAIiN,gBAAgB9M,OAAOe,QAAP,CAAgBgM,wBAAhB,CAApB;AACA,UAAIC,gBAAgBhN,OAAOe,QAAP,CAAgBkM,wBAAhB,CAApB;AACA,UAAIC,QAAQ,EAAZ;;AAEAC,mBAAaD,KAAb,EAAoB,SAApB,EAA+BJ,cAAczL,KAA7C,EAAoDyL,cAAcvL,GAAlE,EAAuE4C,OAAOwI,WAA9E;AACAQ,mBAAaD,KAAb,EAAoB,SAApB,EAA+BF,cAAc3L,KAA7C,EAAoD2L,cAAczL,GAAlE,EAAuE,CAAC4C,OAAO0I,WAA/E;;AAEAK,YAAMxJ,MAAN,IAAgBqF,QAAQqE,cAAR,CAAuB;AACrCpM,cAAM,UAD+B;AAErCkM,eAAOA;AAF8B,OAAvB,CAAhB;;AAKA,eAASC,YAAT,CAAsBD,KAAtB,EAA6BjL,EAA7B,EAAiCZ,KAAjC,EAAwCE,GAAxC,EAA6C8L,UAA7C,EAAyD;AACvD,YAAIA,eAAe,CAAnB,EAAsB;AAClB;AACH;AACD,YAAIC,OAAOD,aAAa5B,KAAKC,GAAL,CAAS2B,UAAT,CAAxB;AACA,YAAItG,OAAOxF,MAAMF,KAAjB;AACA,YAAIkM,QAAQC,4BAA4BF,IAAxC;;AAEAjM,iBAASkM,KAAT;AACAhM,eAAOgM,KAAP;;AAEA,YAAIhM,MAAM,GAAV,EAAe;AACXA,gBAAM,GAAN;AACAF,kBAAQE,MAAMwF,IAAd;AACH;AACD,YAAI1F,QAAQ,CAAZ,EAAe;AACXA,kBAAQ,CAAR;AACAE,gBAAMF,QAAQ0F,IAAd;AACH;AACDmG,cAAMO,IAAN,CAAW;AACPC,sBAAYzL,EADL;AAEPZ,iBAAOA,KAFA;AAGPE,eAAKA;AAHE,SAAX;AAKD;AACF;;AAED,aAASqL,sBAAT,CAAgCe,QAAhC,EAA0CC,MAA1C,EAAkD;AAChD,UAAIC,QAAQF,YAAYC,OAAO,CAAP,IAAYE,qCAAxB,CAAZ;AACA,UAAIC,QAAQJ,YAAYC,OAAO,CAAP,IAAYE,qCAAxB,CAAZ;AACA,aAAOD,QAAQE,KAAR,IAAiB,CAAjB,GACD,CADC,CACC;AADD,QAEDF,QAAQ,CAAR,GACAA,KADA,CACM;AADN,QAEAE,KAJN,CAHgD,CAOnC;AACd;;AAED,aAASxE,YAAT,CAAsByE,QAAtB,EAAgC;AAC9B,UAAIC,SAAJ;AACA,UAAIC,cAAJ;AACA;AACAF,iBAAWzI,QAAQ4I,QAAR,CAAiBH,QAAjB,EAA2BI,4BAA3B,CAAX;;AAEA,eAASC,OAAT,GAAmB;AACfL,iBAASE,cAAT;AACAD,oBAAYK,sBAAsBD,OAAtB,CAAZ;AACH;;AAED,aAAO;AACHhN,eAAO,eAAU8C,MAAV,EAAkB;AACrB+J,2BAAiB/J,MAAjB;AACA,cAAI8J,aAAa,IAAjB,EAAuB;AACnBI;AACH;AACJ,SANE;AAOHrD,cAAM,gBAAY;AACd,cAAIiD,aAAa,IAAjB,EAAuB;AACnBM,iCAAqBN,SAArB;AACH;AACDA,sBAAYC,iBAAiB,IAA7B;AACH;AAZE,OAAP;AAcD;AACF;;AAID,WAAShF,YAAT,CAAsBH,OAAtB,EAA8B;AAC5BA,YAAQyF,GAAR,CAAY,OAAZ;AACAzF,YAAQyF,GAAR,CAAY,UAAZ;;AAEAzF,YAAQU,EAAR,CAAW,OAAX,EAAoB,kBAAU;AAC5B,UAAI,CAAChB,UAAL,EAAiB;AACf,YAAItE,OAAOrE,IAAP,CAAYyE,GAAG,QAAH,CAAZ,MAA8BC,KAAKC,gBAAvC,EAAyD;AACvDgK,wBAAcC,gBAAd,CAA+BrI,MAAMqG,WAAN,CAAkBvI,OAAOrE,IAAzB,EAA+BC,SAASgE,KAAT,CAAeD,UAA9C,CAA/B;AACD;AACF;AACF,KAND;;AAQA;AACAiF,YAAQU,EAAR,CAAW,UAAX,EAAuB,kBAAU;AAC/B,UAAItF,OAAOuJ,UAAX,EAAuB;AACrB,YAAIvJ,OAAOuJ,UAAP,CAAkBiB,aAAlB,CAAgC,UAAhC,MAAgD,CAApD,EAAuD;AACrDrN,uCAA6B6C,OAAO9C,KAApC;AACAG,qCAA2B2C,OAAO5C,GAAlC;AACD;AACF;AACF,KAPD;AAQD;;AAED;;;;AAIA,WAASgD,EAAT,CAAYqK,GAAZ,EAAgB;AACd,WAAO5I,GAAGC,SAAH,CAAa2I,GAAb,EAAkB7O,SAASgE,KAAT,CAAeD,UAAjC,CAAP;AACD;;;AAtoBWkC,Q;;AACAK,W;;AACAoI,mB;;AACAjC,c;;AACAhI,U;;AAELe,a;;AACArB,Y;;;AAEH8C,kB,GAAe,G;AACf3B,wB,GAAqB,C;AACrBH,sB,GAAmB,C;AACnBC,wB,GAAqB,C;AACrBiJ,kC,GAA+B,E;AAC/BrB,8B,GAA2B,C;AAC3BE,8B,GAA2B,C;AAC3BO,+B,GAA4B,G;AAC5BM,2C,GAAwC,E;AAExCrF,gB;AACAyB,iB;AACAgB,iB;AACAd,2B,GAAwB,CAAC,CAAD,EAAI,CAAJ,C;AACxBE,yB;AACAV,qB;AACAiB,iB;AACAlE,uB,GAAoB,E;AACpBC,uB,GAAoB,E;AACpB7G,c;AACAuJ,2B;AAEAZ,c;AACAO,gB;AAEA3H,gC;AACAE,8B","file":"chart_option.js","sourcesContent":["import * as dp from './data_processor'\r\nimport * as utils from './utils'\r\nimport * as order_actions from './order_actions_ctrl'\r\nimport * as dropCtrl from './drop_order_ctrl'\r\nimport * as cons from './constans'\r\n\r\nimport echarts from './libs/echarts.min'\r\nimport moment from 'moment'\r\n\r\nlet HEIGHT_RATIO = 0.6;\r\nlet DIM_CATEGORY_INDEX = 0;\r\nlet DIM_TIME_ARRIVAL = 1;\r\nlet DIM_TIME_DEPARTURE = 2;\r\nlet DATA_ZOOM_AUTO_MOVE_THROTTLE = 30;\r\nlet DATA_ZOOM_X_INSIDE_INDEX = 1;\r\nlet DATA_ZOOM_Y_INSIDE_INDEX = 3;\r\nlet DATA_ZOOM_AUTO_MOVE_SPEED = 0.2;\r\nlet DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH = 30;\r\n\r\nlet _draggable;\r\nlet _draggingEl;\r\nlet _dropShadow;\r\nlet _draggingCursorOffset = [0, 0];\r\nlet _draggingTimeLength;\r\nlet _draggingRecord;\r\nlet _dropRecord;\r\nlet _cartesianXBounds = [];\r\nlet _cartesianYBounds = [];\r\nlet _rawData;\r\nlet _autoDataZoomAnimator;\r\n\r\nlet _myChart\r\nlet _panelCtrl\r\n\r\nlet _bottomSliderDataZoomStart\r\nlet _bottomSliderDataZoomEnd\r\n\r\nexport function getOption (data, ) {\r\n  \r\n  _rawData = data   \r\n  \r\n  let option = {\r\n    tooltip: {\r\n    },\r\n    animation: false,\r\n    toolbox: {\r\n        left: 20,\r\n        top: 0,\r\n        itemSize: 20,\r\n        feature: {\r\n            myDrag: {\r\n                show: true,\r\n                title: 'Make orders\\ndraggable',\r\n                icon: 'path://M990.55 380.08 q11.69 0 19.88 8.19 q7.02 7.01 7.02 18.71 l0 480.65 q-1.17 43.27 -29.83 71.93 q-28.65 28.65 -71.92 29.82 l-813.96 0 q-43.27 -1.17 -72.5 -30.41 q-28.07 -28.07 -29.24 -71.34 l0 -785.89 q1.17 -43.27 29.24 -72.5 q29.23 -29.24 72.5 -29.24 l522.76 0 q11.7 0 18.71 7.02 q8.19 8.18 8.19 18.71 q0 11.69 -7.6 19.29 q-7.6 7.61 -19.3 7.61 l-518.08 0 q-22.22 1.17 -37.42 16.37 q-15.2 15.2 -15.2 37.42 l0 775.37 q0 23.39 15.2 38.59 q15.2 15.2 37.42 15.2 l804.6 0 q22.22 0 37.43 -15.2 q15.2 -15.2 16.37 -38.59 l0 -474.81 q0 -11.7 7.02 -18.71 q8.18 -8.19 18.71 -8.19 l0 0 ZM493.52 723.91 l-170.74 -170.75 l509.89 -509.89 q23.39 -23.39 56.13 -21.05 q32.75 1.17 59.65 26.9 l47.94 47.95 q25.73 26.89 27.49 59.64 q1.75 32.75 -21.64 57.3 l-508.72 509.9 l0 0 ZM870.09 80.69 l-56.13 56.14 l94.72 95.9 l56.14 -57.31 q8.19 -9.35 8.19 -21.05 q-1.17 -12.86 -10.53 -22.22 l-47.95 -49.12 q-10.52 -9.35 -23.39 -9.35 q-11.69 -1.17 -21.05 7.01 l0 0 ZM867.75 272.49 l-93.56 -95.9 l-380.08 380.08 l94.73 94.73 l378.91 -378.91 l0 0 ZM322.78 553.16 l38.59 39.77 l-33.92 125.13 l125.14 -33.92 l38.59 38.6 l-191.79 52.62 q-5.85 1.17 -12.28 0 q-6.44 -1.17 -11.11 -5.84 q-4.68 -4.68 -5.85 -11.7 q-2.34 -5.85 0 -11.69 l52.63 -192.97 l0 0 Z',\r\n                onclick: onDragSwitchClick\r\n            }\r\n        }\r\n    },\r\n    title: {\r\n        text: '',\r\n        left: 'center'\r\n    },\r\n    dataZoom: [{\r\n      type: 'slider',\r\n      xAxisIndex: 0,\r\n      filterMode: 'weakFilter',\r\n      height: 10,\r\n      bottom: 8,\r\n      start: _bottomSliderDataZoomStart || 0,\r\n      end: _bottomSliderDataZoomEnd || 100,\r\n      handleIcon: 'M10.7,11.9H9.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7V23h6.6V24.4z M13.3,19.6H6.7v-1.4h6.6V19.6z',\r\n      handleSize: 15,\r\n      showDetail: false,\r\n      handleStyle: {\r\n          shadowBlur: 6,\r\n          shadowOffsetX: 1,\r\n          shadowOffsetY: 2,\r\n          shadowColor: '#aaa'\r\n      },\r\n    }, {\r\n        type: 'inside',\r\n        id: 'insideX',\r\n        xAxisIndex: 0,\r\n        filterMode: 'weakFilter',\r\n        start: 0,\r\n        end: 26,\r\n        zoomOnMouseWheel: false,\r\n        moveOnMouseMove: true\r\n    }, {\r\n        type: 'slider',\r\n        yAxisIndex: 0,\r\n        zoomLock: true,\r\n        width: 10,\r\n        right: 10,\r\n        top: 70,\r\n        bottom: 20,\r\n        start: 0,\r\n        end: 100,\r\n        handleSize: 0,\r\n        showDetail: false,\r\n    }, {\r\n        type: 'inside',\r\n        id: 'insideY',\r\n        yAxisIndex: 0,\r\n        start: 0,\r\n        end: 100,\r\n        zoomOnMouseWheel: false,\r\n        moveOnMouseMove: true,\r\n        moveOnMouseWheel: true\r\n    }],\r\n    grid: {\r\n        show: true,\r\n        top: 70,\r\n        bottom: 20,\r\n        left: 260,\r\n        right: 20,\r\n        backgroundColor: '#fff',\r\n        borderWidth: 0\r\n    },\r\n    xAxis: {\r\n        type: 'time',\r\n        position: 'top',\r\n        splitLine: {\r\n            lineStyle: {\r\n                color: ['#E9EDFF']\r\n            }\r\n        },\r\n        axisLine: {\r\n            show: false\r\n        },\r\n        axisTick: {\r\n            lineStyle: {\r\n                color: '#929ABA'\r\n            }\r\n        },\r\n        axisLabel: {\r\n            color: '#929ABA',\r\n            inside: false,\r\n            align: 'center'\r\n        }\r\n    },\r\n    yAxis: {\r\n        axisTick: {show: false},\r\n        splitLine: {show: false},\r\n        axisLine: {show: false},\r\n        axisLabel: {show: false},\r\n        min: 0,\r\n        max: _rawData.line.data.length\r\n    },\r\n    series: [\r\n      {\r\n        id: 'flightData',\r\n        type: 'custom',\r\n        renderItem: renderGanttItem,\r\n        dimensions: _rawData.order.dimensions,\r\n        tooltip: {\r\n            formatter: params => {                                \r\n                const startTime = moment(params.data[1]).format('YYYY-MM-DD H:mm:ss')\r\n                const endTime = moment(params.data[2]).format('YYYY-MM-DD H:mm:ss')\r\n                const compl_qty = params.data[fi('compl_qty')] === null ? 0 : params.data[fi('compl_qty')]\r\n\r\n                let tooltip = '<p style=\"text-align:center;margin:0px;color:#999\">Order ID : ' + params.data[fi('order_id')] + '</p>'\r\n                tooltip += '<div style=\"margin:5px 0px 5px 0px; width:100%; height:1px; background: #999\"></div>'\r\n                if (params.data[fi('status')]  === cons.STATE_CHANGEOVER) {\r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Change-Over </strong></p> '\r\n                }else {\r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Product ID :</strong> &nbsp;' + params.data[fi('product_id')] + '</p> '\r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Product Desc :</strong> &nbsp;' + params.data[fi('product_desc')] + '</p> '\r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Planned Qty :</strong> &nbsp;' + params.data[fi('order_qty')] + '</p> '\r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Confirmed Qty :</strong> &nbsp;' + compl_qty + '</p> '\r\n                }\r\n                tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Scheduled Start Time :</strong> &nbsp;' + startTime + '</p> '\r\n                tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Scheduled End Time :</strong> &nbsp;' + endTime + '</p> '\r\n                if (params.data[fi('status')]  === cons.STATE_START || params.data[fi('status')]  === cons.STATE_PAUSE) {\r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Actual Start Time :</strong> &nbsp;' + moment(params.data[fi('actual_start_datetime')]).format('YYYY-MM-DD H:mm:ss') + '</p> ' \r\n                }\r\n                if (params.data[fi('status')]  === cons.STATE_COMPLETE || params.data[fi('status')]  === cons.STATE_CLOSE) {\r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Actual Start Time :</strong> &nbsp;' + moment(params.data[fi('actual_start_datetime')]).format('YYYY-MM-DD H:mm:ss') + '</p> ' \r\n                  tooltip += '<p style=\"margin:0px;color:' + params.color + '\"><strong style=\"font-size:medium\">Actual End Time :</strong> &nbsp;' + moment(params.data[fi('actual_end_datetime')]).format('YYYY-MM-DD H:mm:ss') + '</p> ' \r\n                }\r\n                return tooltip\r\n            },\r\n            backgroundColor: '#eee',\r\n            borderColor: '#aaa',\r\n            borderWidth: 1,\r\n            borderRadius: 4,\r\n        },\r\n        encode: {\r\n            x: [DIM_TIME_ARRIVAL, DIM_TIME_DEPARTURE],\r\n            y: DIM_CATEGORY_INDEX,\r\n        },\r\n        data: _rawData.order.data\r\n      },\r\n      {\r\n        type: 'custom',\r\n        renderItem: renderAxisLabelItem,\r\n        dimensions: _rawData.line.dimensions,\r\n        encode: {\r\n            x: -1, // Then this series will not controlled by x.\r\n            y: 0\r\n        },\r\n        data: echarts.util.map(_rawData.line.data, function (item, index) {\r\n            return [index].concat(item);\r\n        })\r\n      }\r\n    ]\r\n  }\r\n\r\n  return option\r\n}\r\n\r\nfunction renderGanttItem(params, api) {\r\n  \r\n  const status = api.value(dp.findIndex('status', _rawData.order.dimensions))\r\n  const pId = api.value(dp.findIndex('product_id_api', _rawData.order.dimensions))\r\n  const color = dp.getColor(status)\r\n  const highlightColor = utils.highlightColor(color)\r\n  \r\n  var categoryIndex = api.value(DIM_CATEGORY_INDEX);\r\n  var timeArrival = api.coord([api.value(DIM_TIME_ARRIVAL), categoryIndex]);\r\n  var timeDeparture = api.coord([api.value(DIM_TIME_DEPARTURE), categoryIndex]);\r\n\r\n  var coordSys = params.coordSys;\r\n  _cartesianXBounds[0] = coordSys.x;\r\n  _cartesianXBounds[1] = coordSys.x + coordSys.width;\r\n  _cartesianYBounds[0] = coordSys.y;\r\n  _cartesianYBounds[1] = coordSys.y + coordSys.height;\r\n\r\n  var barLength = timeDeparture[0] - timeArrival[0];\r\n  // Get the heigth corresponds to length 1 on y axis.\r\n  var barHeight = api.size([0, 1])[1] * HEIGHT_RATIO;\r\n  var x = timeArrival[0];\r\n  var y = timeArrival[1] - barHeight;\r\n\r\n  var flightNumber = status === cons.STATE_CHANGEOVER ? 'C' : api.value(4) + ' - ' + pId.replace('###', '') + ''\r\n  var flightNumberWidth = echarts.format.getTextRect(flightNumber).width;\r\n  var text = (barLength > flightNumberWidth + 40 && x + barLength >= 180)\r\n      ? flightNumber : '';\r\n\r\n  var rectNormal = clipRectByRect(params, {\r\n      x: x, y: y, width: barLength, height: barHeight\r\n  });\r\n  var rectVIP = clipRectByRect(params, {\r\n      x: x, y: y, width: (barLength) / 2, height: barHeight\r\n  });\r\n  var rectText = clipRectByRect(params, {\r\n      x: x, y: y, width: barLength, height: barHeight\r\n  });\r\n\r\n  return {\r\n      type: 'group',\r\n      children: [{\r\n          type: 'rect',\r\n          ignore: !rectNormal,\r\n          shape: rectNormal,\r\n          style: api.style({fill: color}),\r\n          styleEmphasis: {fill: highlightColor}\r\n      }, \r\n      {\r\n          type: 'rect',\r\n          ignore: !rectVIP && !api.value(4),\r\n          shape: rectVIP,\r\n          style: api.style({fill: color}),\r\n          styleEmphasis: {fill: highlightColor}\r\n      }, \r\n      {\r\n          type: 'rect',\r\n          ignore: !rectText,\r\n          shape: rectText,\r\n          style: api.style({\r\n              fill: 'transparent',\r\n              stroke: '#000000',\r\n              lineWidth: 0.5,\r\n              text: text,\r\n              textFill: '#fff'\r\n          })\r\n      }]\r\n  };\r\n}\r\n\r\nfunction renderAxisLabelItem(params, api) {\r\n  var y = api.coord([0, api.value(0)])[1];\r\n  if (y < params.coordSys.y + 5) {\r\n      return;\r\n  }\r\n  return {\r\n      type: 'group',\r\n      position: [\r\n          10,\r\n          y\r\n      ],\r\n      children: [{\r\n          type: 'path',\r\n          shape: {\r\n              d: 'M0,0 L0,-20 L30,-20 C42,-20 38,-1 50,-1 L70,-1 L70,0 Z',\r\n              x: 0,\r\n              y: -20,\r\n              width: 250,\r\n              height: 20,\r\n              layout: 'cover'\r\n          },\r\n          style: {\r\n              fill: '#368c6c'\r\n          }\r\n      }, {\r\n          type: 'text',\r\n          style: {\r\n              x: 54,\r\n              y: -3,\r\n              text: api.value(1),\r\n              textVerticalAlign: 'bottom',\r\n              textAlign: 'center',\r\n              textFill: '#fff'\r\n          }\r\n      }, {\r\n          type: 'text',\r\n          style: {\r\n              x: 200,\r\n              y: -2,\r\n              textVerticalAlign: 'bottom',\r\n              textAlign: 'center',\r\n              text: api.value(2),\r\n              textFill: '#000'\r\n          }\r\n      }]\r\n  };\r\n}\r\n\r\n\r\nfunction clipRectByRect(params, rect) {\r\n  return echarts.graphic.clipRectByRect(rect, {\r\n    x: params.coordSys.x,\r\n    y: params.coordSys.y,\r\n    width: params.coordSys.width,\r\n    height: params.coordSys.height\r\n  });\r\n}\r\n\r\n\r\n//--------------------------------------------\r\n\r\nfunction onDragSwitchClick(model, api, type) {\r\n  _draggable = !_draggable;\r\n  _myChart.setOption({\r\n      dataZoom: [{\r\n          id: 'insideX',\r\n          disabled: _draggable\r\n      }, {\r\n          id: 'insideY',\r\n          disabled: _draggable\r\n      }]\r\n  });\r\n  this.model.setIconStatus(type, _draggable ? 'emphasis' : 'normal');\r\n}\r\n\r\nexport function interationSetup(myChart, panelCtrl){\r\n  _myChart = myChart\r\n  _panelCtrl = panelCtrl\r\n  \r\n  //set listeners like onclick...\r\n  setListeners(myChart)\r\n\r\n  //init drag function\r\n  initDrag(myChart)\r\n}\r\n\r\nexport function refreshDashboard(){\r\n  _panelCtrl.timeSrv.refreshDashboard()\r\n}\r\n\r\nfunction initDrag(myChart){\r\n  _autoDataZoomAnimator = makeAnimator(dispatchDataZoom);\r\n  myChart.on('mousedown', function (param) {\r\n    // console.log(param.event.offsetX);\r\n    if (!_draggable || !param || param.seriesIndex === null) {\r\n      return;\r\n    }\r\n    // Drag start\r\n    _draggingRecord = {\r\n      dataIndex: param.dataIndex,\r\n      categoryIndex: param.value[DIM_CATEGORY_INDEX],\r\n      timeArrival: param.value[DIM_TIME_ARRIVAL],\r\n      timeDeparture: param.value[DIM_TIME_DEPARTURE],\r\n      cursorPositionX: param.event.offsetX\r\n    };\r\n    var style = {lineWidth: 2, fill: 'rgba(255,0,0,0.1)', stroke: 'rgba(255,0,0,0.8)', lineDash: [6, 3]};\r\n\r\n    _draggingEl = addOrUpdateBar(_draggingEl, _draggingRecord, style, 100);\r\n    _draggingCursorOffset = [\r\n      _draggingEl.position[0] - param.event.offsetX,\r\n      _draggingEl.position[1] - param.event.offsetY\r\n    ];\r\n    _draggingTimeLength = _draggingRecord.timeDeparture - _draggingRecord.timeArrival;\r\n  });\r\n\r\n  myChart.getZr().on('mousemove', function (event) {\r\n    if (!_draggingEl) {\r\n      return;\r\n    }\r\n\r\n    var cursorX = event.offsetX;\r\n    var cursorY = event.offsetY;\r\n\r\n    // Move _draggingEl.\r\n    _draggingEl.attr('position', [\r\n      _draggingCursorOffset[0] + cursorX,\r\n      _draggingCursorOffset[1] + cursorY,\r\n    ]);\r\n\r\n    prepareDrop();\r\n\r\n    autoDataZoomWhenDraggingOutside(cursorX, cursorY);\r\n  });\r\n\r\n  myChart.getZr().on('mouseup', function () {\r\n    // Drop\r\n    if (_draggingEl && _dropRecord) {\r\n\r\n      updateRawData() && myChart.setOption({\r\n        series: {\r\n          id: 'flightData',\r\n          data: _rawData.order.data\r\n        }\r\n      });\r\n    }\r\n    dragRelease();\r\n  });\r\n  myChart.getZr().on('globalout', dragRelease);\r\n\r\n  function dragRelease() {\r\n    _autoDataZoomAnimator.stop();\r\n\r\n    if (_draggingEl) {\r\n      myChart.getZr().remove(_draggingEl);\r\n      _draggingEl = null;\r\n    }\r\n    if (_dropShadow) {\r\n      myChart.getZr().remove(_dropShadow);\r\n      _dropShadow = null;\r\n    }\r\n    _dropRecord = _draggingRecord = null;\r\n  }\r\n\r\n  function addOrUpdateBar(el, itemData, style, z) {\r\n    var pointArrival = myChart.convertToPixel('grid', [itemData.timeArrival, itemData.categoryIndex]);\r\n    //set item shadow to be in the cursor's position\r\n    if (itemData.cursorPositionX) {\r\n      pointArrival[0] = itemData.cursorPositionX - 10\r\n    }\r\n    var pointDeparture = myChart.convertToPixel('grid', [itemData.timeDeparture, itemData.categoryIndex]);\r\n\r\n    // var barLength = pointDeparture[0] - pointArrival[0];\r\n    var barLength = 20\r\n\r\n    var barHeight = Math.abs(\r\n      myChart.convertToPixel('grid', [0, 0])[1] - myChart.convertToPixel('grid', [0, 1])[1]\r\n    ) * HEIGHT_RATIO;\r\n\r\n    if (!el) {\r\n      el = new echarts.graphic.Rect({\r\n        shape: {x: 0, y: 0, width: 0, height: 0},\r\n        style: style,\r\n        z: z\r\n      });\r\n      myChart.getZr().add(el);\r\n    }\r\n    el.attr({\r\n      shape: {x: 0, y: 0, width: barLength, height: barHeight},\r\n      position: [pointArrival[0], pointArrival[1] - barHeight]\r\n    });    \r\n    \r\n    return el;\r\n  }\r\n\r\n  function prepareDrop() {\r\n    // Check droppable place.\r\n    var xPixel = _draggingEl.shape.x + _draggingEl.position[0];\r\n    var yPixel = _draggingEl.shape.y + _draggingEl.position[1];\r\n    var cursorData = myChart.convertFromPixel('grid', [xPixel, yPixel]);      \r\n    \r\n    if (cursorData) {\r\n      // Make drop shadow and _dropRecord\r\n      _dropRecord = {\r\n        categoryIndex: Math.floor(cursorData[1]),\r\n        timeArrival: cursorData[0],\r\n        timeDeparture: cursorData[0] + _draggingTimeLength\r\n      };\r\n      var style = {fill: 'rgba(0,0,0,0.4)'};\r\n      _dropShadow = addOrUpdateBar(_dropShadow, _dropRecord, style, 99);\r\n    }\r\n  }\r\n\r\n  // This is some business logic, don't care about it.\r\n  function updateRawData() {\r\n    const orderData = _rawData.order.data;\r\n    let movingItem = orderData[_draggingRecord.dataIndex];\r\n    //Only Planned and Ready order can be moved.\r\n    if (movingItem[fi('status')] !== cons.STATE_PLAN && movingItem[fi('status')] !== cons.STATE_READY) { return }\r\n    \r\n    // Check if hits anthoer order\r\n    for (let i = 0; i < orderData.length; i++) {\r\n      const dataItem = orderData[i];\r\n      \r\n      //if the dragging item is overlapped with changeover, return\r\n      if (dataItem[fi('status')] === cons.STATE_CHANGEOVER) { return }\r\n      \r\n      //if hits another order, show form\r\n      if (dataItem !== movingItem\r\n        && _dropRecord.categoryIndex === dataItem[DIM_CATEGORY_INDEX]\r\n        && _dropRecord.timeArrival < dataItem[DIM_TIME_DEPARTURE]\r\n        && _dropRecord.timeArrival > dataItem[DIM_TIME_ARRIVAL]\r\n      ) {\r\n        dropCtrl.showForm(utils.mergeKeyVal(movingItem, _rawData.order.dimensions), utils.mergeKeyVal(dataItem, _rawData.order.dimensions))\r\n      }\r\n    }\r\n\r\n    return true;\r\n  }\r\n\r\n  function autoDataZoomWhenDraggingOutside(cursorX, cursorY) {\r\n      // When cursor is outside the cartesian and being dragging,\r\n      // auto move the dataZooms.      \r\n      var cursorDistX = getCursorCartesianDist(cursorX, _cartesianXBounds);\r\n      var cursorDistY = getCursorCartesianDist(cursorY, _cartesianYBounds);\r\n\r\n      if (cursorDistX !== 0 || cursorDistY !== 0) {\r\n        _autoDataZoomAnimator.start({\r\n            cursorDistX: cursorDistX,\r\n            cursorDistY: cursorDistY\r\n        });\r\n      }\r\n      else {\r\n        _autoDataZoomAnimator.stop();\r\n      }\r\n  }\r\n\r\n  function dispatchDataZoom(params) {\r\n    var option = myChart.getOption();\r\n    var optionInsideX = option.dataZoom[DATA_ZOOM_X_INSIDE_INDEX];\r\n    var optionInsideY = option.dataZoom[DATA_ZOOM_Y_INSIDE_INDEX];\r\n    var batch = [];\r\n\r\n    prepareBatch(batch, 'insideX', optionInsideX.start, optionInsideX.end, params.cursorDistX);\r\n    prepareBatch(batch, 'insideY', optionInsideY.start, optionInsideY.end, -params.cursorDistY);\r\n\r\n    batch.length && myChart.dispatchAction({\r\n      type: 'dataZoom',\r\n      batch: batch\r\n    });\r\n\r\n    function prepareBatch(batch, id, start, end, cursorDist) {      \r\n      if (cursorDist === 0) {\r\n          return;\r\n      }\r\n      var sign = cursorDist / Math.abs(cursorDist);\r\n      var size = end - start;\r\n      var delta = DATA_ZOOM_AUTO_MOVE_SPEED * sign;\r\n\r\n      start += delta;\r\n      end += delta;\r\n\r\n      if (end > 100) {\r\n          end = 100;\r\n          start = end - size;\r\n      }\r\n      if (start < 0) {\r\n          start = 0;\r\n          end = start + size;\r\n      }\r\n      batch.push({\r\n          dataZoomId: id,\r\n          start: start,\r\n          end: end\r\n      });\r\n    }\r\n  }\r\n\r\n  function getCursorCartesianDist(cursorXY, bounds) {\r\n    var dist0 = cursorXY - (bounds[0] + DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH);\r\n    var dist1 = cursorXY - (bounds[1] - DATA_ZOOM_AUTO_MOVE_DETECT_AREA_WIDTH);\r\n    return dist0 * dist1 <= 0\r\n        ? 0 // cursor is in cartesian\r\n        : dist0 < 0\r\n        ? dist0 // cursor is at left/top of cartesian\r\n        : dist1; // cursor is at right/bottom of cartesian\r\n  }\r\n\r\n  function makeAnimator(callback) {\r\n    var requestId;\r\n    var callbackParams;\r\n    // Use throttle to prevent from calling dispatchAction frequently.\r\n    callback = echarts.throttle(callback, DATA_ZOOM_AUTO_MOVE_THROTTLE);\r\n\r\n    function onFrame() {\r\n        callback(callbackParams);\r\n        requestId = requestAnimationFrame(onFrame);\r\n    }\r\n\r\n    return {\r\n        start: function (params) {\r\n            callbackParams = params;\r\n            if (requestId == null) {\r\n                onFrame();\r\n            }\r\n        },\r\n        stop: function () {\r\n            if (requestId != null) {\r\n                cancelAnimationFrame(requestId);\r\n            }\r\n            requestId = callbackParams = null;\r\n        }\r\n    };\r\n  }\r\n}\r\n\r\n\r\n\r\nfunction setListeners(myChart){\r\n  myChart.off('click')\r\n  myChart.off('dataZoom')\r\n\r\n  myChart.on('click', params => {\r\n    if (!_draggable) {\r\n      if (params.data[fi('status')] !== cons.STATE_CHANGEOVER) {\r\n        order_actions.showOrderActions(utils.mergeKeyVal(params.data, _rawData.order.dimensions))\r\n      }\r\n    }\r\n  })\r\n\r\n  //get current datazoom slider's start and end points so that the slider will not reset after refreshing the page\r\n  myChart.on('dataZoom', params => {\r\n    if (params.dataZoomId) {\r\n      if (params.dataZoomId.localeCompare('series00') === 0) {\r\n        _bottomSliderDataZoomStart = params.start\r\n        _bottomSliderDataZoomEnd = params.end\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\n/**\r\n * Find the index that match the key in the order dimensions array\r\n * @param {*} key \r\n */\r\nfunction fi(key){\r\n  return dp.findIndex(key, _rawData.order.dimensions)\r\n}\r\n"]}