{"version":3,"sources":["../src/utils.js"],"names":["sortMax","data","sort","a","b","order_id","mergeKeyVal","arr","dimension","i","length","elem","mergeKeyArrayVal","order","o","subElem","push","findDistinct","Array","from","Set","getLineStartTime","line","l","split","target","_prodLineDetails","filter","site","area","production_line","start_time","queryProductionLineDetails","callback","url","postgRestHost","get","then","res","catch","alert","e","highlightColor","hexColor","rgb","hexToRgb","r","g","rgbToHex","componentToHex","hex","shorthandRegex","replace","m","result","exec","parseInt","c","toString","appEvents","hostname","window","location","influxHost","Promise","resolve","reject","xhr","XMLHttpRequest","open","onreadystatechange","handleResponse","onerror","send","readyState","status","JSON","parse","responseText","statusText","post","type","title","msg","emit","showModal","html","src","modalClass","model","copyObject","json","stringify","obj"],"mappings":"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","file":"utils.js","sourcesContent":["import { appEvents } from 'app/core/core'\n\nconst hostname = window.location.hostname\nexport const influxHost = 'http://' + hostname + ':8086/'\nexport const postgRestHost = 'http://' + hostname + ':5436/'\n\nlet _prodLineDetails\n\nexport const get = url => {\n  return new Promise((resolve, reject) => {\n      var xhr = new XMLHttpRequest()\n      xhr.open('GET', url)\n      xhr.onreadystatechange = handleResponse\n      xhr.onerror = e => reject(e)\n      xhr.send()\n\n      function handleResponse () {\n      if (xhr.readyState === 4) {\n          if (xhr.status === 200) {\n          var res = JSON.parse(xhr.responseText)\n          resolve(res)\n          } else {\n          reject(this.statusText)\n          }\n      }\n      }\n  })\n}\n\nexport const post = (url, line) => {\n  return new Promise((resolve, reject) => {\n    var xhr = new XMLHttpRequest()\n    xhr.open('POST', url)\n    xhr.onreadystatechange = handleResponse\n    xhr.onerror = e => reject(e)\n    xhr.send(line)\n\n    function handleResponse () {\n      if (xhr.readyState === 4) {\n        if (xhr.status === 200) {\n          // console.log('200');\n          var res = JSON.parse(xhr.responseText)\n          resolve(res)\n        } else if (xhr.status === 204) {\n          // console.log('204');\n          res = xhr.responseText\n          resolve(res)\n        } else {\n          reject(this.statusText)\n        }\n      }\n    }\n  })\n}\n\nexport const alert = (type, title, msg) => {\n  appEvents.emit('alert-' + type, [title, msg])\n}\n\nexport const showModal = (html, data) => {\n  appEvents.emit('show-modal', {\n    src: 'public/plugins/smart-factory-production-schedule-gantt-chart-panel/partials/' + html,\n    modalClass: 'confirm-modal',\n    model: data\n  })\n}\n\nexport function sortMax(data){\n  return data.sort((a, b) => b.order_id - a.order_id)\n}\n\nexport const copyObject = obj => {\n  const json = JSON.stringify(obj)\n  return JSON.parse(json)\n}\n\nexport function mergeKeyVal(arr, dimension){\n  let data = {}\n  for (let i = 0; i < arr.length; i++) {\n    const elem = arr[i];\n    data[dimension[i]] = elem\n  }\n  return data\n}\n\nexport function mergeKeyArrayVal(arr, dimension){\n  let data = []\n  for (let i = 0; i < arr.length; i++) {\n    const elem = arr[i];\n    let order = {}\n    for (let o = 0; o < elem.length; o++) {\n      const subElem = elem[o];\n      order[dimension[o]] = subElem\n    }\n    data.push(order)\n  }\n  return data\n}\n\nexport function findDistinct(arr){\n  return Array.from(new Set(arr))\n}\n\n/**\n * pass in the line, return the line's default start time\n * @param {*} line \n */\nexport function getLineStartTime(line){\n  const l = line.split(' | ')\n  const target = _prodLineDetails.filter(line => line.site === l[0] && line.area === l[1] && line.production_line === l[2])\n  if (target.length === 0) {\n    return '6:00:00'\n  }else {\n    if (target[0].start_time) {\n      return target[0].start_time\n    }else {\n      return '6:00:00'\n    }\n  }\n}\n\n/**\n * It sends query to postgres db to get production line details and then\n * set the results global in this utils file for further uses.\n * Then execute the callback funtion when finished.\n */\nexport function queryProductionLineDetails(callback){\n  const url = postgRestHost + 'equipment?site=not.is.null&area=not.is.null&production_line=not.is.null&equipment=is.null'\n  get(url).then(res => {\n    _prodLineDetails = res\n    callback()\n  }).catch(e => {\n    alert('error', 'Error', 'An error has occurred due to ' + e + ', please refresh the page and try again')\n  })\n}\n\nexport function highlightColor(hexColor){\n  const rgb = hexToRgb(hexColor)\n  rgb.r >= 235 ? rgb.r = 255 : rgb.r += 20\n  rgb.g >= 235 ? rgb.g = 255 : rgb.g += 20\n  rgb.b >= 235 ? rgb.b = 255 : rgb.b += 20\n  return rgbToHex(rgb.r, rgb.g, rgb.b)\n}\n\nfunction rgbToHex(r, g, b){\n  return \"#\" + componentToHex(r) + componentToHex(g) + componentToHex(b)\n}\n\nfunction hexToRgb(hex) {\n  let shorthandRegex = /^#?([a-f\\d])([a-f\\d])([a-f\\d])$/i;\n  hex = hex.replace(shorthandRegex, function(m, r, g, b) {\n      return r + r + g + g + b + b;\n  });\n\n  let result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n  return result ? {\n      r: parseInt(result[1], 16),\n      g: parseInt(result[2], 16),\n      b: parseInt(result[3], 16)\n  } : null;\n}\n\nfunction componentToHex(c){\n  let hex = c.toString(16)\n  return hex.length === 1 ? \"0\" + hex : hex;\n}\n\n\n\n"]}